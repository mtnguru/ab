!function(a){"use strict";Drupal.behaviors.atomizer={attach:function(a,r){if(!Drupal.atomizer.base){Drupal.atomizer.base=Drupal.atomizer.baseC();for(var e in drupalSettings.atomizer)Drupal.atomizer.viewerC(drupalSettings.atomizer[e])}}}}(jQuery);
!function(a){"use strict";Drupal.atomizer.animationC=function(t){function e(){var a=d.theme.get("animation--speed")/1e3,t=d.camera.position.x,e=d.camera.position.y,i=d.camera.position.z;d.camera.position.x=t*Math.cos(a)+i*Math.sin(a),d.camera.position.y=e*Math.cos(a)-t*Math.sin(a),d.camera.position.z=i*Math.cos(a)-t*Math.sin(a),d.camera.lookAt(d.scene.position)}function i(){var a=p.val();c!=a?(c=a,Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{directory:d.atomizer.animateDirectory,filepath:d.atomizer.animateDirectory+"/"+c,filename:c,component:"animation"},v)):"paused"==u?(u="running",r()):m()}function n(){for(var a in l.timers)clearTimeout(f[a]);f={}}function o(){for(var a in l.timers){var t=l.timers[a];f[a]=setTimeout(function(){s(a,t)},t.time)}}function s(a,t){switch(a){case"loadatoms":z>=t.atoms.length-1?z=0:z++,n(),u="paused",d.atom.loadAtom(t.atoms[z].nid,function(){t.atoms[z].time&&(t.time=t.atoms[z].time)})}}function m(){u="running";l.timers&&(l.timers.loadatoms&&(l.timers.loadatoms.time=l.timers.loadatoms.atoms[0].time),o()),l.animations&&(u="running",r())}function r(){"running"==u&&requestAnimationFrame(r),l.animations.rotation&&"orbitals"===l.animations.rotation.name&&e(),d.render()}var c,l,d=t,u="stopped",p=a("#animation--selectyml select"),f={},z=-1,h=a("#blocks--animation--wrapper").find(".az-button"),v=function(a){c=a[0].data.filename,l=a[0].ymlContents,localStorage.setItem("atomizer_animation_file",c),p.val(c),m()};return{buttonClicked:function(t){switch(t.id){case"animation--play":i(),h.removeClass("az-selected"),a(t).addClass("az-selected");break;case"animation--pause":u="paused",n(),h.removeClass("az-selected"),a(t).addClass("az-selected");break;case"animation--stop":u="stopped",n(),h.removeClass("az-selected"),a(t).addClass("az-selected")}},loadYml:v}}}(jQuery);
!function(t){Drupal.atomizer.atomC=function(a){function e(t,a,e,n){for(var r="0"==t?[12,13,14,15,20]:[16,17,18,19,21],o=0;o<r.length;o++)a.az.protons[r[o]].material.visible=n,a.az.protons[r[o]].az.visible=n,a.az.protons[r[o]].az.active=e}function n(t,a,r){var o=m.nuclet.createNuclet(t,a),l=o.children[0],i=o.children[0].children[0];if(i.az.attachAngle=a.attachAngle,r.add(o),"N0"!=i.az.id){var c=i.az.id.substr(i.az.id.length-1),u=i.az.id.slice(0,-1);e(c,s.az.nuclets[u],!1,!1);var z,v;0==c?(z=0,v=10,l.initial_rotation_y=-18):(z=2,v=10,l.initial_rotation_y=-198);var f=s.az.nuclets[u].az.protons[z].position.clone(),d=new THREE.Vector3(0,31,0),h=new THREE.Vector3(0,13,0);f.y=f.y+11;var p=i.az.protonGeometry.vertices[v].clone().normalize(),g=new THREE.Vector3(0,1,0),b=d.clone().sub(f),A=b.length();b.normalize(),Drupal.atomizer.base.alignObjectToAxis(i,p,g,!1),Drupal.atomizer.base.alignObjectToAxis(o,g,b,!1);var y=h.clone().add(b.multiplyScalar(2.28*-A));o.position.set(y.x,y.y,y.z),l.rotation.y=(l.initial_rotation_y+72*((a.attachAngle||1)-1))/180*Math.PI}if(s.az.nuclets[i.az.id]=i,a.nuclets)for(var t in a.nuclets)n(t,a.nuclets[t],i),e(t.charAt(t.length-1),i,!1,!1);return o}function r(){var t=m.theme.get("valence-active--color"),a=m.theme.get("valence-inactive--color");for(var e in s.az.nuclets){var n=s.az.nuclets[e];if("initial"===n.az.state||"final"===n.az.state)for(var r in n.az.rings)if(n.az.rings.hasOwnProperty(r)){var o=n.az.rings[r],l=(n.az.id,o.az.grow,t);s.az.nuclets[n.az.id+o.az.grow]||n.az.protons[o.az.lock[0]].az.visible&&n.az.protons[o.az.lock[1]].az.visible?l=a:0,o.material.color.setHex(parseInt(l.replace(/#/,"0x")),16)}}}function o(){var a=0;for(var e in s.az.nuclets){0;var n=s.az.nuclets[e];for(var r in n.az.protons){var o=n.az.protons[r];o.az?o.az.visible&&a++:0}}t("#atom--num-protons .text-value").html(a)}function l(t){var a=t.target.id.split("-")[1];f(a,null),t.preventDefault()}function i(){function t(a,e){var n=s.az.nuclets[a],r=e+a+":\n";r+=(e+="  ")+"state: "+n.az.state+"\n","N0"!==a&&(r+=e+"attachAngle: "+n.az.conf.attachAngle+"\n"),r+=e+"protons: [";for(var o=0,l=0;l<n.az.protons.length;l++)if(n.az.protons[l]){var i=n.az.protons[l];i.az.active&&i.az.visible&&(o++&&(r+=", "),r+=l)}r+="]\n";var c=s.az.nuclets[a+"0"],u=s.az.nuclets[a+"1"];return(c||u)&&(r+=e+"nuclets:\n",c&&(r+=t(a+"0",e+"  ")),u&&(r+=t(a+"1",e+"  "))),r}return t("N0","")}function c(){var a=t(".select-atom",t(m.context).parents("article"));if(a)for(var e=0;e<a.length;e++)a[e].addEventListener("click",l,!1)}var s,u,m=a,z=t("#atom--information",m.context)[0],v=t("#view-select-atom"),f=function(t,a){u=a,Drupal.atomizer.base.doAjax("/ajax-ab/loadAtom",{nid:t},d)},d=function(t){for(var a=0;a<t.length;a++){var e=t[a];"loadAtomCommand"==e.command&&(z&&(z.innerHTML=e.data.teaser),jQuery("#atom--save a").replaceWith(e.data.link),Drupal.attachBehaviors&&Drupal.attachBehaviors("#atom--save a"),s?(m.scene.remove(s),s.az):{nuclets:{}},h(e.data.atomConf.N0),s.az.nid=e.data.nid,m.producer.atomLoaded(s),u&&u())}},h=function(t){return s=new THREE.Group,s.name="atom",s.az={nuclets:{}},m.atom.atom=s,n("N0",t,s),r(),o(),m.scene.add(s),m.render(),s},p=function(a){t("#theme--selectyml")[0].querySelector("select")};return t("#atom--select-close").click(function(){v.toggleClass("enabled")}),Drupal.behaviors.atomizer_atom={attach:function(a,e){c();var n=t(".node-atom-form, .node-atom-edit-form")[0];n&&(n.getElementsByClassName("field--name-field-atomic-structure")[0].getElementsByTagName("textarea")[0].value=i())}},c(),{addNuclet:function(t){conf={state:"lithium",attachAngle:3,protons:[10,1,4,5,3,11,9],electrons:[0,1,2]};var a=s.az.nuclets[t.slice(0,-1)];e(t.charAt(t.length-1),a,!1,!1);var l=n(t,conf,a);return r(),o(),l.children[0].children[0]},addProton:function(t,a){},az:function(){return s.az},buttonClicked:function(t){"atom--select"==t.id&&v.toggleClass("enabled")},changeNucletState:function(t,a){var e=t.az.id,o=t.az.attachAngle,l=t.parent.parent.parent;return m.nuclet.deleteNuclet(t),t=n(e,{state:a,attachAngle:o},l).children[0].children[0],r(),t},changeNucletAngle:function(t,a){var e=s.az.nuclets[t];e.parent.rotation.y=(e.parent.initial_rotation_y+72*(a-1))/180*Math.PI,e.az.conf.attachAngle=a},createAtom:h,deleteNuclet:function(t){var a=s.az.nuclets[t],n=s.az.nuclets[t.slice(0,-1)];m.nuclet.deleteNuclet(a),e(t.charAt(t.length-1),n,!0,!1),r(),o()},getNuclet:function(t){return s.az.nuclets[t]?s.az.nuclets[t]:null},getYmlDirectory:function(){return"config/atom"},loadAtom:f,overwriteYml:function(t){Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:currentSet.name,component:"theme",filename:currentSet.filename,ymlContents:currentSet},null)},saveYml:function(t){currentSet.name=t.name,currentSet.filename=t.filename,Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:t.name,component:"theme",filename:t.filename,ymlContents:currentSet},p)},setValenceRings:r,showStats:o}}}(jQuery);
!function(a){Array.prototype.contains=function(a){for(var n in this)if(this[n]==a)return!0;return!1},Drupal.atomizer={},Drupal.atomizer.baseC=function(){Drupal.AjaxCommands.prototype.loadYmlCommand=function(a,n,r){Drupal.atomizer[n.component].loadYml(n)},Drupal.AjaxCommands.prototype.saveYmlCommand=function(a,n,r){Drupal.atomizer[n.component].saveYml(n)},Drupal.AjaxCommands.prototype.renderNodeCommand=function(a,n,r){Drupal.atomizer[n.component].renderNode(n)};return{doAjax:function(n,r,t,o){a.ajax({url:n,type:"POST",data:JSON.stringify(r),contentType:"application/json; charset=utf-8",processData:!1,success:function(a){return Array.isArray(a)&&a.length>0?(a[0].data&&a[0].data.message&&alert(a[0].data.message),t&&t(a)):o?o(a):t(a),!1},error:function(a){alert("atomizer_base doAjax: "+a.responseText),o?o(a):t(a)}})},alignObjectToAxis:function(a,n,r,t){var o=new THREE.Vector3;o.crossVectors(n,r).normalize(),radians=Math.acos(n.dot(r)),a.quaternion.setFromAxisAngle(o,t?-radians:radians)},initDraggable:function(a,n,r,t){},constants:{visibleThresh:.03,transparentThresh:.97}}}}(jQuery);
!function(e){Drupal.atomizer.controlsC=function(t,a){function n(e){switch(E){case"atom_builder":g.dispose(),delete g,y.canvasContainer.removeEventListener("mousemove",h);break;case"camera":g.dispose(),delete g;break;case"atom":k.dispose(),delete k;break;case"attach":y.canvasContainer.removeEventListener("mousemove",h)}switch(E=e){case"atom_builder":g=m(),y.canvasContainer.addEventListener("mousemove",h,!1),y.canvasContainer.addEventListener("mouseup",b,!1);break;case"camera":g=m();break;case"atom":k=p(Drupal.atomizer.octolet);break;case"attach":y.canvasContainer.addEventListener("mousemove",h,!1)}}function o(t){var a=this.id.split("--");this.className.indexOf("az-slider")>-1?e("#"+a[0]+"--"+a[1]+"--"+a[2]+"--az-value",y.context)[0].value=t.target.value:this.className.indexOf("az-control-range")>-1&&(e("#"+this.id+"--az-value",y.context)[0].value=t.target.value),y.theme.applyControl(this.id,t.target.value)}function r(e){var t=this.id.split("--");Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{component:t[0],filepath:y[t[0]].getYmlDirectory()+"/"+e.target.value,filename:e.target.value},y[t[0]].loadYml)}function s(t){t.preventDefault();var a=this.id.split("--");switch(a[1]){case"selectyml":y[a[0]].overwriteYml();break;case"saveyml":var n=e("3"+a[0]+"--saveyml",y.context)[0],o=n.querySelector("input[name=name]").value,r=n.querySelector("input[name=filename]").value;o.length&&(0==r.length&&(r=o),-1==r.indexOf(".yml")&&(r+=".yml"),y[a[0]].saveYml({name:o,filepath:y[a[0]].getYmlDirectory()+"/"+r.replace(/[|&;$%@"<>()+,]/g,"").replace(/[ -]/g,"_")}));break;default:"viewer"===a[0]?y.buttonClicked(t.target):y[a[0]]&&y[a[0]].buttonClicked&&(t.preventDefault(),y[a[0]].buttonClicked(t.target))}return!1}function i(t){if(null==a){$html='<div class="NaN';var a=e("#blocks--popup",y.context);$html='<div class="az-popup"><div class="az-popup-titlebar"><div class="az-popup-title">Yo Dude</div></div><div class="az-popup-content">Hey James</div></div>'}}function c(t){t.preventDefault();var a=e(t.target).data("nid"),n=e(t.target).data("viewmode");Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{nid:a,viewMode:n,popupId:"popupNode"},i)}function l(){if(y.atomizer.theme)for(var t in y.atomizer.theme.settings){var a=y.atomizer.theme.settings[t],n=t.replace(/_/g,"-");if(e("#"+n,y.context)[0]||"rotation"==a.type||"position"==a.type)switch(a.type){case"color":case"range":y.theme.set(a.defaultValue,n,a.type);break;case"rotation":case"position":var o;o=n+"--az-slider",y.theme.set(a.defaultValue,o,a.type)}}}function d(){for(var t=0;t<C.length;t++)if(C[t].selected){var a=C[t].id.split("--")[1];u(e(a))}}function u(t){e("#blocks--theme .control-block").addClass("az-hidden");var a=e("#blocks--"+C.value);a.insertAfter(e(C)),a.removeClass("az-hidden")}function v(){if(l(),e(".az-controls-form",y.context)[0]){d(),C.addEventListener("change",function(t){u(e("#blocks--"+t.value))});for(var t in y.atomizer.theme.settings){var a=y.atomizer.theme.settings[t],n=t.replace(/_/g,"-"),i=e("#"+n,y.context)[0];if(i||"rotation"==a.type||"position"==a.type)switch(a.type){case"color":case"range":i.addEventListener("input",o);break;case"rotation":case"position":var v=n+"--az-slider";e("#"+v,y.context)[0].addEventListener("input",o),y.theme.set(a.defaultValue,v,a.type);break;case"saveyml":e("#"+n+"--button",y.context)[0];e("#"+n+"--button",y.context)[0].addEventListener("click",s);break;case"selectyml":i.addEventListener("change",r);break;case"link":case"button":case"toggle":i.addEventListener("click",s);break;case"popup-node":i.addEventListener("click",c)}}return e(".toggle-block").click(function(t){var a=e("#"+e(this).data("blockid"));if(a.hasClass("az-hidden")){var n=e(this).data("blockid");a.removeClass("az-hidden"),e(this).addClass("az-selected"),a.insertAfter(e("#blocks--buttons")),"blocks--theme"===n&&d()}else a.addClass("az-hidden"),e(this).removeClass("az-selected")}),!1}}function m(){var e=new THREE.OrbitControls(y.camera,y.renderer.domElement);return e.rotateSpeed=.25,e.zoomSpeed=.5,e.panSpeed=.5,e.enableZoom=!0,e.enablePan=!0,e.enableDamping=!0,e.dampingFactor=.3,e.keys=[65,83,68],e}function p(e){var t=new THREE.TrackballControls(e,y.renderer.domElement);return t.rotateSpeed=2,t.zoomSpeed=1,t.panSpeed=3,t.noZoom=!1,t.noPan=!1,t.staticMoving=!0,t.keys=[65,83,68],t.addEventListener("change",y.render),t}function f(e){if(e){var t=new THREE.Vector3(x.x,x.y,.5);t.unproject(y.camera);var a=new THREE.Raycaster(y.camera.position,t.sub(y.camera.position).normalize());y.render();var n=a.intersectObjects(e);if(n.length);return n}return[]}function h(e){x.x=e.offsetX/y.canvasWidth*2-1,x.y=-e.offsetY/y.canvasHeight*2+1,y.producer.hoverObjects&&y.producer.hovered(f(y.producer.hoverObjects())),y.render()}function b(e){if(x.x=e.offsetX/y.canvasWidth*2-1,x.y=-e.offsetY/y.canvasHeight*2+1,y.producer.mouseClick)return y.producer.mouseClick(e)}var g,k,z,y=t,E=(Drupal.atomizer.base.constants,"none"),C=e("#theme--selectBlock",y.context)[0],x=new THREE.Vector2(-1e3,-1e3);return{init:function(){v(),n("atom_builder"),y.producer.setDefaults&&y.producer.setDefaults(),(z=new THREE.Raycaster).ray.direction.set(0,-1,0),y.controls.projector=new THREE.Projector},getDefault:function(t,a){var n=e("#"+t,y.context);return n.length?n.hasClass("az-control-range")||n.hasClass("az-control-rotation")||n.hasClass("az-control-position")?a?e("#"+t+"--"+a+"--az-slider",y.context)[0].value:e("#"+t+"--az-slider",y.context)[0].value:n.hasClass("az-control-radios")?e("input[name="+n.attr("id")+"]:checked").val():n.val():(console.log("atomizer_controls.js - control not found - "+t),null)},findIntersects:f,cameraTrackballControls:g}}}(jQuery);
jQuery,Drupal.atomizer.nucletC=function(e){function t(e,t,r){for(var a=new THREE.Geometry,o=b.theme.get(e+"Axes--opacity"),n=new THREE.LineBasicMaterial({color:b.theme.get(e+"Axes--color"),opacity:o,transparent:o<R.transparentThresh,visible:o>R.visibleThresh,linewidth:2}),i=0;i<t.vertices.length;i++){var s;s=r.vertices[t.vertices[i][0]],a.vertices.push(new THREE.Vector3(s.x,s.y,s.z)),s=r.vertices[t.vertices[i][1]],a.vertices.push(new THREE.Vector3(s.x,s.y,s.z))}var c=new THREE.LineSegments(a,n);return t.scale&&c.scale.set(t.scale,t.scale,t.scale),c.name=e+"Axes",c}function r(e,t,r){for(var a=new THREE.Geometry,o=new THREE.LineBasicMaterial({color:16711935,opacity:r,transparent:r<R.transparentThresh,visible:r>R.visibleThresh,linewidth:2}),n=0;n<t.length;n++){var i=t[n];a.vertices.push(new THREE.Vector3(i.x,i.y,i.z))}var s=new THREE.LineSegments(a,o);return s.name=e+"Lines",s}function a(e,t,r,a){var o=b.theme.get(e+"--opacity"),n=new THREE.Mesh(r,new THREE.MeshBasicMaterial({color:b.theme.get(e+"--color"),opacity:o,transparent:o<R.transparentThresh,visible:o>R.visibleThresh,wireframe:!0,wireframeLinewidth:b.theme.get(e+"--linewidth")}));if(n.scale.set(t,t,t),n.name=e,a)for(var i in z){var s=z[i];if(a[s]){var c=a[s]/360*2*Math.PI;n.rotation["init_"+s]=c,n.rotation[s]=c}}return T(e,n),n}function o(e,t,r,a){var o=b.theme.get(e+"--opacity"),n=new THREE.LineBasicMaterial({color:b.theme.get(e+"--color"),opacity:o,transparent:o<R.transparentThresh,visible:o>R.visibleThresh,linewidth:b.theme.get(e+"--linewidth")}),i=new THREE.Group;i.name=e;for(var s=0;s<r.azfaces.length;s++){for(var c,l=r.azfaces[s],h=new THREE.Geometry,p=0;p<l.indices.length;p++)c=r.vertices[l.indices[p]],h.vertices.push(new THREE.Vector3(c.x,c.y,c.z));c=r.vertices[l.indices[0]],h.vertices.push(new THREE.Vector3(c.x,c.y,c.z)),i.add(new THREE.Line(h,n))}if(i.scale.set(t,t,t),a)for(var v in z){var d=z[v];if(a[d]){var m=a[d]/360*2*Math.PI;i.rotation["init_"+d]=m,i.rotation[d]=m}}return T(e,i),i}function n(e,t,r,a,o){var n;if(o){r.dynamic=!0;var i=new THREE.MeshLambertMaterial({color:b.theme.get(e+"--color"),opacity:b.theme.get(e+"--opacity"),transparent:!0,vertexColors:THREE.FaceColors}),s=new THREE.MeshLambertMaterial({color:b.theme.get(e+"--color"),opacity:0,transparent:!0,vertexColors:THREE.FaceColors});n=new THREE.Mesh(r,new THREE.MultiMaterial([s,i]));for(h=0;h<o.length;h++)r.faces[o[h]].materialIndex=1}else{var c=b.theme.get(e+"--opacity"),l=new THREE.MeshStandardMaterial({color:b.theme.get(e+"--color"),opacity:c,transparent:c<R.transparentThresh,visible:c>R.visibleThresh,roughness:.5,metalness:0,vertexColors:THREE.FaceColors});n=new THREE.Mesh(r,l)}if(n.scale.set(t,t,t),n.name=e,a)for(var h in z){var p=z[h];if(a[p]){var v=a[p]/360*2*Math.PI;n.rotation["init_"+p]=v,n.rotation[p]=v}}return T(e,n),n}function i(e,t,r,a){var o;switch(e){case"plane":!0,o=new THREE.PlaneGeometry(r.width||1e3,r.depth||1e3);break;case"proton":case"sphere":o=new THREE.SphereGeometry(r.radius||b.theme.get("proton--radius"),r.widthSegments||36,r.heightSegments||36);break;case"electron":o=new THREE.SphereGeometry(r.radius||b.theme.get("electron--radius"),r.widthSegments||24,r.heightSegments||24);break;case"octahedron":o=new THREE.OctahedronGeometry(r.length||3);break;case"tetrahedron":o=new THREE.TetrahedronGeometry(r.length||3);break;case"icosahedron":o=new THREE.IcosahedronGeometry(r.length||3);break;case"dodecahedron":o=new THREE.DodecahedronGeometry(r.length||3);break;case"cube":var n=r.length||4;o=new THREE.BoxGeometry(n,n,n);break;case"pentagonalBipyramid":o=w(5,r.length,r.height)}var i=[];t.wireframe&&i.push(new THREE.MeshBasicMaterial(t.wireframe)),t.lambert&&i.push(new THREE.MeshLambertMaterial(t.lambert)),t.phong&&i.push(new THREE.MeshPhongMaterial(t.phong)),t.doubleSided&&(i[0].side=THREE.DoubleSide);var s;return s=1==i.length?new THREE.Mesh(o,i[0]):new THREE.SceneUtils.createMultiMaterialObject(o,i),r.scale&&s.scale.set(r.scale,r.scale,r.scale),a.rotation&&(a.rotation.x&&(s.rotation.x=a.rotation.x),a.rotation.y&&(s.rotation.y=a.rotation.y),a.rotation.z&&(s.rotation.z=a.rotation.z)),s.position.x=a.x||0,s.position.y=a.y||0,s.position.z=a.z||0,s.name=e,s}function s(e,t,r,a,o){switch(e){case"neutral":case"lithium":case"boron":case"beryllium":case"icosahedron":return b.shapes.getGeometry("icosahedron","final",r,null,o);case"decahedron":return b.shapes.getGeometry("decahedron","final",r,a,o);case"line":var n=new THREE.Geometry,i=2*x;return n.vertices.push(new THREE.Vector3(i,0,0)),n.vertices.push(new THREE.Vector3(0,0,0)),n.vertices.push(new THREE.Vector3(-i,0,0)),n;case"tetrahedron":return new THREE.TetrahedronGeometry(r,o);case"dodecahedron":case"hexahedron":case"backbone":return b.shapes.getGeometry(e,t,r,null,o);case"octahedron":return new THREE.OctahedronGeometry(r,o)}}function c(e,t){var r;if((r=b.theme.get("proton--color-style"))||(r="nuclet"),"nuclet"===r&&e&&e.state&&void 0!==e.state){if("hydrogen"===e.state||"helium"===e.state)return"proton-default";if("neutral"===t)return"proton-neutral";if("initial"===e.state){for(var a=[12,13,14,15,16,17,18,19],o=0;o<a.length;o++)if(-1===e.conf.protons.indexOf(a[o]))return"proton-initial";return"proton-capped"}return"proton-"+e.state}return"proton"===r&&t&&void 0!==t?"proton-"+t:"proton-default"}function l(e,t,r,a){var o,n={type:e.type||"default",visible:!("visible"in e)||e.visible,optional:e.optional||!1,active:e.active||!0},t=b.theme.get("proton--opacity");o=!1!==n.active&&(!1!==n.visible&&t>R.visibleThresh);var s=c(a,n.type),l=i("proton",{phong:{color:H[s.replace("proton-","")],opacity:t,transparent:t<R.transparentThresh,visible:o}},{scale:b.theme.get("proton--scale"),radius:x},{x:r.x,y:r.y,z:r.z});return l.name=s,l.material.visible=o,l.az=n,l}function h(e){}function p(e,t,r){var a=b.theme.get(e+"--opacity"),o=new THREE.AxisHelper(t);return o.name=e,o.material.linewidth=r,o.material.opacity=a,o.material.visible=a>.02,o.material.transparent=a<.97,o}function v(e,t,r){var a;switch(r.state){case"neutral":e.vertices[9].set(0,.1616236535868876*x,.0998889113026354*x);break;case"beryllium":for(vids=[0,2],a=0;a<vids.length;a++)e.vertices[vids[a]].x=1.2*e.vertices[vids[a]].x;e.vertices[9].set(0,.2*x,0);break;case"boron":for(vids=[0,2],a=0;a<vids.length;a++)e.vertices[vids[a]].x=1.23*e.vertices[vids[a]].x,e.vertices[vids[a]].y=.95*e.vertices[vids[a]].y;for(vids=[4,5,6,7],a=0;a<vids.length;a++)e.vertices[vids[a]].z=.85*e.vertices[vids[a]].z;e.vertices[9].set(0,.95*x,0);break;case"lithium":e.vertices[9].set(0,.1616236535868876*x,.0998889113026354*x)}r.protons=[],r.protonGeometry=e;var o=b.theme.get("proton--opacity");for(a in t.protons)if(t.protons.hasOwnProperty(a)){r.conf.protons.indexOf(parseInt(a));t.protons[a].visible=r.conf.protons.indexOf(parseInt(a))>-1;var n=l(t.protons[a],o,e.vertices[a],r);r.protons[a]=n}return r.protons}function d(e,t){var r=b.theme.get("valence-active--color"),a=b.theme.get("valence--opacity"),o=b.theme.get("valence--scale")*x,n=b.theme.get("valence--diameter")*x;t.rings=[];for(var i in e.valence){var s=e.valence[i],c=new THREE.TorusGeometry(o,n,10,40),l=new THREE.MeshPhongMaterial({color:r,opacity:a,transparent:a<R.transparentThresh,visible:a>R.visibleThresh}),h=new THREE.Mesh(c,l);h.name="valence-active",h.az=s,t.rings[i]=h,s.rotation&&(s.rotation.x&&(h.rotation.x=s.rotation.x/360*2*Math.PI),s.rotation.y&&(h.rotation.y=s.rotation.y/360*2*Math.PI),s.rotation.z&&(h.rotation.z=s.rotation.z/360*2*Math.PI)),t.protons[parseInt(i)].add(h)}}function m(e,t,r){r.tetrahedrons=[];for(var a=0;a<e.tetrahedrons.length;a++){var o=G("tetra");o.azid="t"+a,r.tetrahedrons[a]=o,o.children[1].geometry.protons=[];for(var n=0;n<4;n++){var i=e.tetrahedrons[a].vertices[n];o.children[0].geometry.vertices[n].x=t.vertices[i].x,o.children[0].geometry.vertices[n].y=t.vertices[i].y,o.children[0].geometry.vertices[n].z=t.vertices[i].z,o.children[1].geometry.vertices[n].x=t.vertices[i].x,o.children[1].geometry.vertices[n].y=t.vertices[i].y,o.children[1].geometry.vertices[n].z=t.vertices[i].z,o.protons[n]=r.protons[i]}}return r.tetrahedrons}function u(e,t,r,a){var o=b.theme.get("electron--opacity")||1,n=b.theme.get(e+"--scale"),s=[];for(var c in r.electrons)if(r.electrons.hasOwnProperty(c)&&(!a.electrons||a.electrons.contains(c))){var l=t.vertices[c],h=i("electron",{phong:{color:b.theme.get("electron--color"),opacity:o,transparent:o<R.transparentThresh,visible:o>R.visibleThresh}},{scale:b.theme.get("proton--scale"),radius:M},{x:l.x*n,y:l.y*n,z:l.z*n});h.name="electron",T("electrons",h),s[c]=h}return s}function E(e,t,r){return"dodecahedron"==r.shape||"hexahedron"==r.shape?o(e,r.scale+.02,t,r.rotation||null):a(e,r.scale+.02,t,r.rotation||null)}function f(e,r,a,o,i){var c=s(a.shape,i.state||"",a.scale*x,(a.scaleHeight||1)*x);c.compConf=a,c.scaleInit=a.scale;var l;if(r.rotation&&(r.rotation.x&&(l=r.rotation.x/360*2*Math.PI,c.applyMatrix((new THREE.Matrix4).makeRotationX(l))),r.rotation.y&&(l=r.rotation.y/360*2*Math.PI,c.applyMatrix((new THREE.Matrix4).makeRotationY(l))),r.rotation.z&&(l=r.rotation.z/360*2*Math.PI,c.applyMatrix((new THREE.Matrix4).makeRotationZ(l)))),a.protons)for(var h=v(c,a,i),p=0;p<h.length;p++)h[p]&&o.add(h[p]);if(a.valence&&d(a,i),a.tetrahedrons)for(var f=m(a,c,i),y=0;y<f.length;y++)o.add(f[y]);if(a.electrons)for(var g=u(e,c,a,i.conf),w=0;w<g.length;w++)o.add(g[w]);if(a.axes&&o.add(t(e,a.axes,c)),a.wireframe&&o.add(E(e+"Wireframe",c,a)),a.faces){if(a.assignFaceOpacity&&i.conf.reactiveState){var T=i.conf.reactiveState[e]?i.conf.reactiveState[e].slice():[];c.reactiveState=i.reactiveState=T,c.compConf=a}var R=n(e+"Faces",a.scale,c,a.rotation||null,i.reactiveState);o.add(R)}return a.vertexids&&o.add(b.sprites.createVerticeIds(e,c)),a.faceids&&o.add(b.sprites.createFaceIds(e,c)),a.particleids&&o.add(b.sprites.createVerticeIds(a.particleids,c)),c}function y(e,t,r){var a=new THREE.Group;a.name=e;var o=parseFloat(b.theme.get(e+"--scale"));if(a.scale.set(o,o,o),t.alignyaxis){var n=r.protonGeometry.vertices[t.alignyaxis.vertices[0]],i=r.protonGeometry.vertices[t.alignyaxis.vertices[1]],s=n.clone().sub(i);Drupal.atomizer.base.alignObjectToAxis(a,new THREE.Vector3(0,1,0),s.clone().normalize(),!1);var c=new THREE.Vector3(0,0,0).add(s).multiplyScalar(t.alignyaxis.attachPt);a.position.set(c.x,c.y,c.z);var l=t.alignyaxis.rotatey/360*2*Math.PI;a.rotation.y=l}for(var h in t.components)t.components.hasOwnProperty(h)&&f(e,t,t.components[h],a,r);return a}function g(e){b.atom.az().nuclets[e.az.id+"0"]&&g(b.atom.az().nuclets[e.az.id+"0"]),b.atom.az().nuclets[e.az.id+"1"]&&g(b.atom.az().nuclets[e.az.id+"1"]);for(var t=0;t<e.az.protons.length;t++)e.az.protons[t]&&h([e.az.protons[t]]);delete b.atom.az().nuclets[e.az.id],e.parent.parent.parent.remove(e.parent.parent)}function w(e,t,r){var a=new THREE.Geometry;mesth,a.vertices.push(new THREE.Vector3(0,r,0)),a.vertices.push(new THREE.Vector3(0,-r,0));for(var o=2*Math.PI/e,n=0,i=Math.PI;n<e;n++,i+=o){var s=Math.cos(i),c=Math.sin(i);a.vertices.push(new THREE.Vector3(t*s,0,t*c))}for(n=2;n<e+1;n++)a.faces.push(new THREE.Face3(n+1,n,0)),a.faces.push(new THREE.Face3(1,n,n+1));return a.faces.push(new THREE.Face3(2,e+1,0)),a.faces.push(new THREE.Face3(1,e+1,2)),a.computeFaceNormals(),a}function T(e,t){b.objects||(b.objects={}),b.objects[e]?b.objects[e].push(t):b.objects[e]=[t]}var b=e,R=Drupal.atomizer.base.constants,z=["x","y","z"],H={default:b.theme.get("proton-default--color"),ghost:b.theme.get("proton-ghost--color"),valence:b.theme.get("proton-valence--color"),grow:b.theme.get("proton-grow--color"),polar:b.theme.get("proton-polar--color"),neutral:b.theme.get("proton-neutral--color"),lithium:b.theme.get("proton-lithium--color"),beryllium:b.theme.get("proton-beryllium--color"),boron:b.theme.get("proton-boron--color"),carbon:b.theme.get("proton-carbon--color"),initial:b.theme.get("proton-initial--color"),capped:b.theme.get("proton-capped--color"),final:b.theme.get("proton-final--color")},x=b.theme.get("proton--radius"),M=b.theme.get("electron--radius"),G=function(e){var t=new THREE.Group;t.name="tetrahedron",t.protons=[],t.protonRadius=x;var r=new THREE.TetrahedronGeometry(1.222*b.nuclet.protonRadius);return r.dynamic=!0,t.add(b.nuclet.createGeometryWireframe(e+"Wireframe",1,r,null,null)),t.add(b.nuclet.createGeometryFaces(e+"Faces",1,r,null,null)),t};return{makeObject:i,makeProton:l,showProtons:function(e,t,r){for(var a=0;a<r.length;a++){var o=e.az.protons[r[a]];t?(o.material.visible=!0,o.material.opacity=1,o.material.transparent=!1):(o.material.visible=!1,o.material.opacity=0,o.material.transparent=!0)}},createNuclet:function(e,t){var a=new THREE.Group;a.name="nuclet-"+e,t.state=t.state.replace("backbone-",""),a.az={protonRadius:x,conf:t,id:e,state:t.state},a.geo=drupalSettings.atomizer_config.objects[t.state];var o,n;switch(a.az.state){case"dodecahedron":o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];break;case"neutral":o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],n=[0,1,2,3,4,5];break;case"lithium":o=[0,1,3,4,5,9,11],n=[0,1,2];break;case"beryllium":o=[1,3,4,5,6,7,9,10,11],n=[0,1,2];break;case"boron":o=[1,2,3,4,5,6,7,9,10,11],n=[0,1,2];break;case"initial":case"final":o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],n=[0,1,2,3,4,5];break;case"carbon":case"icosahedron":o=[0,1,2,3,4,5,6,7,8,9,10,11],n=[0,1,2,3,4,5]}a.az.conf.electrons||(a.az.conf.electrons=n),a.az.conf.protons||(a.az.conf.protons=o),"N0"!=e&&((l=a.az.conf.protons.indexOf(10))>-1&&(a.az.conf.protons[l]=void 0),"boron"===a.az.conf.state&&(l=a.az.conf.protons.indexOf(0))>-1&&(a.az.conf.protons[l]=void 0));for(var i in a.geo.geoGroups)if(a.geo.geoGroups.hasOwnProperty(i)){var c=y(i,a.geo.geoGroups[i],a.az);a.add(c)}if(a.add(p("nucletAxes",6*x,1)),a.az.conf.rotation)for(var l in z){var h=z[l];if(a.az.conf.rotation[h]){var v=a.az.conf.rotation[h]/360*2*Math.PI;a.rotation["init_"+h]=v,a.rotation[h]=v}}var d=s("icosahedron","",x,1);d.applyMatrix((new THREE.Matrix4).makeRotationY(.5*Math.PI));var m=r("attach",[d.vertices[9],d.vertices[10]],b.theme.get("attachLines--opacity"));m.scale.set(5,5,5),a.add(m);var u=new THREE.Object3D;u.name="nucletInner-"+e,u.add(a),u.add(p("nucletInnerAxes",5*x,3));var E=new THREE.Object3D;return E.name="nucletOuter-"+e,E.add(u),E.add(p("nucletOuterAxes",4*x,5)),a.az.conf.position&&(E.position.x=a.az.conf.position.x||0,E.position.y=a.az.conf.position.y||0,E.position.z=a.az.conf.position.z||0),E},deleteNuclet:g,createGeometry:s,createGeometryWireframe:a,createGeometryFaces:n,protonRadius:x}};
Drupal.atomizer.shapesC=function(e){function t(e,t){var r=(1+Math.sqrt(5))/2,c=[0,1,r,0,-1,r,0,1,-r,0,-1,-r,r,0,1,r,0,-1,-r,0,-1,-r,0,1,1,r,0,-1,r,0,1,-r,0,-1,-r,0],s=[9,0,8,9,8,2,10,1,11,10,11,3,8,0,4,1,4,0,10,4,1,4,5,8,10,5,4,2,8,5,5,3,2,10,3,5,9,2,6,6,2,3,3,11,6,9,6,7,7,6,11,9,7,0,0,7,1,11,1,7];THREE.PolyhedronGeometry.call(this,c,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}function r(e,t,r){var c=[1.3584752137243,1.0361372789803,0,1.5425983561874,-.95086776219312,0,-1.3584752137243,1.0361372789803,0,-1.5425983561874,-.95086776219312,0,.99043524980164,0,-1.6512282239033,-.99043524980164,0,-1.6512282239033,-.99043524980164,0,1.6512282239033,.99043524980164,0,1.6512282239033,0,1.6749956538651,-1.2913717329017,0,1.6749956538651,1.2913717329017,0,-1.605,-1,0,-1.605,1,1.9197063907443,1.7431021759466,1.7651180413022,2.8555615478674,.17282948323074,.99775880481776,2.8555615478674,.17282948323074,-.99775880481776,1.9197063907443,1.7431021759466,-1.7651180413022,-1.9197063907443,1.7431021759466,-1.7651180413022,-2.8555615478674,.17282948323074,-.99775880481776,-2.8555615478674,.17282948323074,.99775880481776,-1.9197063907443,1.7431021759466,1.7651180413022,2.85,1.9,0,-2.85,1.9,0],s=c.length/3;this.vertices=[];for(var a=0;a<s;a++){var o=3*a,n=c[o]*t,i=c[o+1]*t,h=c[o+2]*t;"final"==e&&(0!=a&&2!=a||(n*=.906),8!=a&&9!=a||(h*=1.094)),this.vertices.push(new THREE.Vector3(n,i,h))}this.type="BackboneGeometry",this.parameters={radius:t,detail:r}}function c(e,t){var r=(1+Math.sqrt(5))/2,c=1/r,s=[1,1,1,c,r,0,-c,r,0,-1,1,1,0,c,r,1,1,-1,r,0,c,0,-c,r,-r,0,c,-1,1,-1,1,-1,-1,c,-r,0,-c,-r,0,-1,-1,-1,0,-c,-r,r,0,-c,1,-1,1,-1,-1,1,-r,0,-c,0,c,-r],a=[15,10,14,15,14,19,15,19,5,5,19,9,5,9,2,5,2,1,14,13,18,14,18,9,14,9,19,10,11,12,10,12,13,10,13,14,6,16,11,6,11,10,6,10,15,0,6,15,0,15,5,0,5,1,9,18,8,9,8,3,9,3,2,13,12,17,13,17,8,13,8,18,17,12,11,17,11,16,17,16,7,4,7,16,4,16,6,4,6,0,3,4,0,3,0,1,3,1,2,8,17,7,8,7,4,8,4,3];THREE.PolyhedronGeometry.call(this,s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.azfaces=[{indices:[5,19,14,10,15],faces:[0,1,2]},{indices:[1,2,9,19,5],faces:[3,4,5]},{indices:[9,18,13,14,19],faces:[6,7,8]},{indices:[10,11,12,13,14],faces:[9,10,11]},{indices:[6,15,10,11,16],faces:[12,13,14]},{indices:[0,1,5,15,6],faces:[15,16,17]},{indices:[2,3,8,18,9],faces:[18,19,20]},{indices:[8,17,12,13,18],faces:[21,22,23]},{indices:[7,16,11,12,17],faces:[24,25,26]},{indices:[0,6,16,7,4],faces:[27,28,29]},{indices:[0,1,2,3,4],faces:[30,31,32]},{indices:[3,4,7,17,8],faces:[33,34,35]}]}function s(e,t){var r=[1,1,1,1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1],c=[0,1,3,1,2,3,4,5,7,5,6,7,4,7,3,7,0,3,6,5,1,5,2,1,7,6,0,6,1,0,3,2,4,2,5,4];THREE.PolyhedronGeometry.call(this,r,c,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.azfaces=[{indices:[0,1,2,3],faces:[0,1]},{indices:[4,5,6,7],faces:[2,3]},{indices:[0,3,4,7],faces:[4,5]},{indices:[1,6,5,2],faces:[6,7]},{indices:[0,7,6,1],faces:[8,9]},{indices:[2,5,4,3],faces:[10,11]}]}function a(e,t,r){var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(0,r,0)),c.vertices.push(new THREE.Vector3(0,-r,0));for(var s=2*Math.PI/e,a=0,o=Math.PI;a<e;a++,o+=s){var n=Math.cos(o),i=Math.sin(o);c.vertices.push(new THREE.Vector3(t*n,0,t*i))}for(a=2;a<e+1;a++)c.faces.push(new THREE.Face3(a+1,a,0)),c.faces.push(new THREE.Face3(1,a,a+1));return c.faces.push(new THREE.Face3(2,e+1,0)),c.faces.push(new THREE.Face3(1,e+1,2)),c.computeFaceNormals(),c}(t.prototype=Object.create(THREE.PolyhedronGeometry.prototype)).constructor=t,(r.prototype=Object.create(THREE.PolyhedronGeometry.prototype)).constructor=r,(c.prototype=Object.create(THREE.PolyhedronGeometry.prototype)).constructor=c,(s.prototype=Object.create(THREE.PolyhedronGeometry.prototype)).constructor=s;return{createPyramid:function(e,t,r){var c=r/2,s=new THREE.Geometry;s.vertices.push(new THREE.Vector3(0,c,0));for(var a=2*Math.PI/e,o=0,n=Math.PI;o<e;o++,n+=a){var i=Math.cos(n),h=Math.sin(n);s.vertices.push(new THREE.Vector3(t*i,-c,t*h))}for(o=1;o<e;o++)s.faces.push(new THREE.Face3(o+1,o,0));s.faces.push(new THREE.Face3(1,e,0));for(o=2;o<e;o++)s.faces.push(new THREE.Face3(o,o+1,1));return s.computeFaceNormals(),s},createBiPyramid:a,getGeometry:function(e,o,n,i,h){switch(e){case"icosahedron":return new t(n,h);case"dodecahedron":return new c(n,h);case"decahedron":return a(5,n,i);case"hexahedron":return new s(n,h);case"backbone":return new r(o,n,h)}}}};
Drupal.atomizer.spritesC=function(e,r){function t(e,r){var t,o,a;for(t=0,o=e.length;t<o;t++)(a=e[t]).centroid=new THREE.Vector3,a.centroid.set(0,0,0),a.centroid.add(r[a.a]),a.centroid.add(r[a.b]),a.centroid.add(r[a.c]),a.centroid.divideScalar(3)}function o(e,r,t,o,a,i){e.beginPath(),e.moveTo(r+i,t),e.lineTo(r+o-i,t),e.quadraticCurveTo(r+o,t,r+o,t+i),e.lineTo(r+o,t+a-i),e.quadraticCurveTo(r+o,t+a,r+o-i,t+a),e.lineTo(r+i,t+a),e.quadraticCurveTo(r,t+a,r,t+a-i),e.lineTo(r,t+i),e.quadraticCurveTo(r,t,r+i,t),e.closePath(),e.fill(),e.stroke()}function a(e,r){void 0===r&&(r={});var t=r.hasOwnProperty("fontface")?r.fontface:"Arial",a=r.hasOwnProperty("fontsize")?r.fontsize:16,i=r.hasOwnProperty("borderThickness")?r.borderThickness:0,n=r.hasOwnProperty("borderColor")?r.borderColor:"#990099",c=r.hasOwnProperty("backgroundColor")?r.backgroundColor:"#009999",s=r.hasOwnProperty("color")?r.color:"#ffffff",d=document.createElement("canvas"),l=d.getContext("2d");l.font="Bold "+a+"px "+t;var f=l.measureText(e).width;l.fillStyle=c,l.strokeStyle=n,l.lineWidth=i,o(l,0,0,f,1.35*a+i,8),l.fillStyle=s,l.fillText(e,i,a);var v=l.getImageData(0,0,f,88);d.width=f,d.height=88,l.putImageData(v,0,0);var p=new THREE.Texture(d);p.needsUpdate=!0;var u=new THREE.SpriteMaterial({map:p});u.opacity=r.opacity||0,u.transparent=r.transparent||!1,u.visible=r.visible||!0;var h=new THREE.Sprite(u);return h.scale.set(20,20,1),h}var i=e;return{createVerticeIds:function(e,r){var t=new THREE.Group;t.name=e+"Vertexids";var o=i.theme.get(e+"Vertexid--opacity"),n="proton"==e?"Vertexid--color":"Wireframe--color";n=e+n;for(var c={fontsize:60,color:"#000000",backgroundColor:i.theme.get(n),opacity:o,transparent:o<.97,visible:o>.03},s=0;s<r.vertices.length;s++){var d=a(" "+s+" ",c);d.name=e+"Vertexid",l=2,d.position.x=l*r.vertices[s].x,d.position.y=l*r.vertices[s].y,d.position.z=l*r.vertices[s].z,t.add(d)}var l=1;return t.scale.set(l,l,l),t},createFaceIds:function(e,r){var o=new THREE.Group;t(r.faces,r.vertices),o.name=e+"Faceids";for(var n=i.theme.get(e+"Faceid--opacity"),c={fontsize:60,color:i.theme.get(e+"Wireframe--color"),backgroundColor:"#000000",opacity:n,transparent:n<.97,visible:n>.03},s=0;s<r.faces.length;s++){var d=a(" "+s+" ",c);d.name=e+"Faceid",l=2,d.position.x=l*r.faces[s].centroid.x,d.position.y=l*r.faces[s].centroid.y,d.position.z=l*r.faces[s].centroid.z,o.add(d)}var l=1;return o.scale.set(l,l,l),o}}};
!function(e){"use strict";Drupal.atomizer.themeC=function(a,t){var i=a,r={},l={},n=i.atomizer.themeDirectory,s=e("#theme--message",i.context)[0],o=function(a){localStorage.setItem("atomizer_theme_file",a[0].data.filename),e("#blocks--theme select.form-select").val(a[0].data.filename),a[0].ymlContents&&(a[0].ymlContents.filepath=a[0].data.filepath,l=a[0].ymlContents,r.name?(d(!1,!1),r.name=l.name,r.description=l.description,r.filepath=l.filepath):(r=JSON.parse(JSON.stringify(l)),d(!0,!0)),t&&(t(),t=null))},m=function(e){s.innerHTML=".... Loading Theme list",Drupal.atomizer.base.doAjax("/ajax-ab/listDirectory",{directory:n,component:"theme"},c)},c=function(a){for(var t=e("#theme--selectyml--select",i.context)[0];t.hasChildNodes();)t.removeChild(t.lastChild);for(var l in a[0].filelist){var n=document.createElement("option");n.appendChild(document.createTextNode(a[0].filelist[l])),n.value=l,t.appendChild(n)}t.value=r.filepath.replace(/^.*[\\\/]/,"");e("#theme--saveNewName",i.context)[0].value="";s.innerHTML="Theme saved successfully",setTimeout(function(){s.innerHTML=""},3e3)},f=function(e){var a=e.settings,t=Object.keys(a).sort();delete e.settings,e.settings={};for(var i in t){t[i];e.settings[t[i]]=a[t[i]]}Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:e.name,component:"theme",filepath:e.filepath,ymlContents:e},m)},d=function(a,t){var i;for(var n in r.settings)if("[object Array]"===Object.prototype.toString.call(r.settings[n].defaultValue)){var s=n.split("--"),o="xyz".indexOf(s[2]);if(i=l.settings[n].defaultValue[o],t||r.settings[n].defaultValue[o]!=i){a||p(n,i);var m;(m=e("#"+n)[0])&&(m.value=i),(m=e("#"+n+"--az-value")[0])&&(m.value=i)}}else l.settings[n]?i=l.settings[n].defaultValue:console.log("Error: No defaultValue found for "+n+" in "+l.filepath),(t||r.settings[n].defaultValue!=i)&&(a||p(n,l.settings[n].defaultValue),(m=e("#"+n)[0])&&(m.className.indexOf("az-control-range")>-1?(e("#"+n+"--az-slider").val(i),e("#"+n+"--az-value").val(i)):m.value=i))},p=function(e,a){var t=e.split("--"),l=t[0].split("-");switch(4===t.length?r.settings[t[0]+"--"+t[1]+"--"+t[2]+"--"+t[3]].defaultValue=a:3===t.length?r.settings[t[0]+"--"+t[1]+"--"+t[2]].defaultValue=a:r.settings[t[0]+"--"+t[1]].defaultValue=a,l[0]){case"renderer":i.renderer.setClearColor(new THREE.Color(parseInt(a.replace(/^#/,""),16)),1);break;case"camera":"perspective"==t[1]&&(i.camera.fov=a,i.camera.updateProjectionMatrix());break;default:i.scene.traverse(function(e){var i=e.name.split("-"),n=!1;if("atom"==t[0]?"atom"==i[0]&&(n=!0):"decahedron"==t[0]?"lithium"==i[0]&&(n=!0):t[0].indexOf("wireframe")>-1&&"scale"==t[1]&&i[0].indexOf("face")>-1&&i[0].charAt(0)==t[0].charAt(0)?n=!0:2==l.length?t[0]==e.name&&(n=!0):i[0]==l[0]&&(n=!0),n)switch(t[1]){case"rotation":var s=a/360*2*Math.PI;e.rotation[t[2]]=s+(e.rotation["init_"+t[2]]||0);break;case"position":e.position[t[2]]=a;break;case"scale":var o=a;console.log("applyControl  configuration "+o),e.scale.set(o,o,o);break;case"width":case"depth":"plane"==l[0]&&(e.geometry=THREE.PlaneBufferGeometry(r["plane--width"],r["plane--depth"]));break;case"opacity":var m=a,c=a>.02,f=a<.97;if("proton"==l[0])e.az.active&&(e.material.opacity=m,e.material.visible=c,e.material.transparent=f);else if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.opacity=m,e.children[d].material.visible=c,e.children[d].material.transparent=f;else e.material.opacity=m,e.material.visible=c,e.material.transparent=f;else e.material.materials?(e.material.materials[1].opacity=m,e.material.materials[1].visible=c,e.material.materials[1].transparent=f):e.material[0]?(e.material[0].opacity=m,e.material[0].visible=c,e.material[0].transparent=f):(e.material.opacity=m,e.material.visible=c,e.material.transparent=f);break;case"linewidth":if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.linewidth=a,e.children[d].material.visible=a>.05;else e.material.visible=a>.05,e.material.wireframeLinewidth=a;else e.material.linewidth=a,e.material.visible=a>.05;break;case"color":switch(l[0]){case"ambient":case"spotlight":e.color.setHex(parseInt(a.replace(/#/,"0x")),16);break;default:if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.color.setHex(parseInt(a.replace(/#/,"0x")),16);else e.material.color.setHex(parseInt(a.replace(/#/,"0x")),16);else if(e.material.materials)for(var d=0;d<e.material.materials.length;d++)e.material.materials[d].color.setHex(parseInt(a.replace(/#/,"0x")),16);else e.material.color.setHex(parseInt(a.replace(/#/,"0x")),16)}}})}i.render()},h=localStorage.getItem("atomizer_theme_file");return h&&"undefined"!=h||(h=i.view.defaultTheme),i.view.themePath=i.atomizer.themeDirectory+"/"+h,Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{filepath:i.view.themePath,filename:h,directory:n,component:"theme"},o),{buttonClicked:function(a){switch(a.id){case"theme--saveButton":f(r);break;case"theme--saveNewButton":var t=e("#theme--saveNewName").val();if(t.length){var l=t.replace(/[|&;$%@"<>()+,]/g,"").replace(/[ -]/g,"_");-1==l.indexOf(".yml")&&(l+=".yml"),r.name=t,r.filepath=n+"/"+l,s.classList.remove("az-error"),s.innerHTML=".... Saving theme",f(r),setTimeout(function(){s.innerHTML=""},3e3)}else s.innerHTML="Please enter a Name....",s.classList.add("az-error");break;case"theme--reset":d();break;case"theme--cameraReset":i.camera.position.x=i.theme.get("camera--position","x"),i.camera.position.y=i.theme.get("camera--position","y"),i.camera.position.z=i.theme.get("camera--position","z"),i.camera.lookAt(i.scene.position),i.render()}},applyControl:p,loadYml:o,get:function(e,a){var t=e.split("--"),l=e;return a&&(l+="--"+a),"position"!=t[1]&&"rotation"!=t[1]||(l+="--az-slider"),r.settings[l]?r.settings[l].defaultValue:i.controls.getDefault(l,a)},set:function(e,a,t){r.settings[a]||(r.settings[a]={defaultValue:e,type:t})},getCurrentControls:function(){return r.settings},getYmlDirectory:function(){return n}}}}(jQuery);
!function(e){Drupal.atomizer.producers={},Drupal.atomizer.viewerC=function(a){function t(e,a){var t=new THREE.SpotLight(a.c);return t.position.set(a.x||-40,a.y||60,a.z||-10),t.castShadow=!0,t.name=e,t}function n(e){for(var a={},t=e;(t=t.parentElement)&&!t.classList.contains("az-view-mode-atomizer"););if(t&&t.attributes["data-az"]){var n=t.attributes["data-az"].value.split(" ");for(var i in n)if(n.hasOwnProperty(i)){var r=n[i].split("-");a[r[0]]=r[1]}}return a}var i,r=[],o={objects:{},context:e("#az-id-"+a.atomizerId.toLowerCase())},s=!1,c=function(){o.renderer.render(o.scene,o.camera)},l=function(){var a=o.atomizer.atomizerId.replace(/[ _]/g,"-").toLowerCase()+"-canvas-wrapper";if(o.canvasContainer=e("#"+a)[0],o.dataAttr=n(o.canvasContainer),o.canvas=o.canvasContainer.getElementsByTagName("canvas")[0],o.canvasWidth=o.canvasContainer.clientWidth,o.atomizer.canvasRatio&&"window"!==o.atomizer.canvasRatio)o.canvasHeight=o.canvasWidth*o.atomizer.canvasRatio;else{var s=window.innerHeight/window.innerWidth;o.canvasHeight=o.canvasWidth*s}o.canvas.height=o.canvasHeight,o.producer=Drupal.atomizer.producers[o.view.producer+"C"](o),o.scene=new THREE.Scene,o.scene.position.set(0,0,0),o.controls=Drupal.atomizer.controlsC(o);var l={antialias:!0,canvas:o.canvas};o.renderer=new THREE.WebGLRenderer(l),o.renderer.setClearColor(o.theme.get("renderer--color"),1),o.renderer.setSize(o.canvasWidth,o.canvasHeight),o.renderer.shadowEnabled=!0,o.canvasContainer.appendChild(o.renderer.domElement),window.addEventListener("resize",function(){if(o.canvasWidth=o.canvasContainer.clientWidth,o.atomizer.canvasRatio&&"window"!==o.atomizer.canvasRatio)o.canvasHeight=o.canvasWidth*o.atomizer.canvasRatio;else{var e=window.innerHeight/window.innerWidth;o.canvasHeight=o.canvasWidth*e}o.canvas.width=o.canvasWidth,o.canvas.height=o.canvasHeight,o.renderer.setSize(o.canvas.width,o.canvas.height),o.renderer.setViewport(0,0,o.canvas.width,o.canvas.height),o.camera.aspect=o.canvas.width/o.canvas.height,o.camera.updateProjectionMatrix(),o.render()}),o.camera=new THREE.PerspectiveCamera(o.theme.get("camera--perspective"),o.canvasWidth/o.canvasHeight,.1,1e4),zoom=o.dataAttr.zoom?o.dataAttr.zoom:1,o.camera.position.set(zoom*o.theme.get("camera--position","x"),zoom*o.theme.get("camera--position","y"),zoom*o.theme.get("camera--position","z")),o.camera.lookAt(o.scene.position),o.controls.init(),(i=new THREE.AmbientLight(o.theme.get("ambient--color"))).name="ambient",o.scene.add(i);for(var d=1;d<4;d++)r[d]=t("spotlight-"+d,{c:o.theme.get("spotlight-"+d+"--color"),x:o.theme.get("spotlight-"+d+"--position","x"),y:o.theme.get("spotlight-"+d+"--position","y"),z:o.theme.get("spotlight-"+d+"--position","z")}),o.scene.add(r[d]);o.nuclet=Drupal.atomizer.nucletC(o),o.shapes=Drupal.atomizer.shapesC(o),o.sprites=Drupal.atomizer.spritesC(o),o.animation=Drupal.atomizer.animationC(o);o.theme.get("plane--color");o.scene.add(o.nuclet.makeObject("plane",{lambert:{color:o.theme.get("plane--color"),opacity:o.theme.get("plane--opacity"),transparent:!0}},{width:o.theme.get("plane--width"),depth:o.theme.get("plane--depth")},{x:o.theme.get("plane--position","x"),y:o.theme.get("plane--position","y"),z:o.theme.get("plane--position","z"),rotation:{x:-.5*Math.PI}})),o.producer.createView(),c()};return o.context.hover(function(){var e=window.scrollX,a=window.scrollY;this.focus(),window.scrollTo(e,a)},function(){this.blur()}).keyup(function(e){switch(e.keyCode){case 70:s=!s,screenfull.toggle(o.context[0]),s?o.context.addClass("az-fullscreen"):o.context.removeClass("az-fullscreen"),e.preventDefault()}}),o.context.dblclick(function(){s&&(s=!1,o.context.removeClass("az-fullscreen"),screenfull.exit())}),Drupal.behaviors.atomizer_viewer={attach:function(a,t){e(".az-dialog").each(function(a){e(this).hasClass("az-dialog-processed")||e(this).addClass("az-dialog-processed")})}},o.buttonClicked=function(e){"viewer--fullScreen"===e.id&&((s=!s)?(screenfull.request(o.context[0]),o.context.addClass("az-fullscreen")):(screenfull.exit(),o.context.removeClass("az-fullscreen")))},o.render=c,o.makeScene=l,o.atomizer=a,o.view=a.views[a.defaultView],o.theme=Drupal.atomizer.themeC(o,l),o}}(jQuery);
!function(e){Drupal.atomizer.producers.atom_builderC=function(t){function a(e){var t=e.target.id.split("-",2)[1],a=m.atom.addNuclet(t);m.atom.setValenceRings(),n(),r(a),m.render()}function n(){k=[],A=[];var e=m.atom.az().nuclets;for(var t in e)if(e.hasOwnProperty(t))for(var a=e[t].az.protons,n=0;n<a.length;n++)a[n]&&(a[n].az.active&&k.push(a[n]),a[n].az.visible&&A.push(a[n]))}function o(e,t){var n=t.getElementsByTagName("LABEL")[0],o=t.getElementsByTagName("DIV")[0];if(n.innerHTML=e,m.atom.az().nuclets[e])o.innerHTML=m.atom.az().nuclets[e].az.state;else{o.innerHTML="";var r=document.createElement("input");r.setAttribute("type","button"),r.setAttribute("name","nuclet-add-"+e+"-button"),r.setAttribute("value","Add"),r.classList.add("nuclet-list-button"),r.id="nuclet-"+e,r.addEventListener("click",a),t.getElementsByTagName("DIV")[0].appendChild(r)}}function r(t){var a=t.az.id;c(m.atom.atom),x.insertAfter(y.find(".nuclet-"+a)),"hydrogen"!=t.az.conf.state&&"helium"!=t.az.conf.state&&(e("#nuclet--state--"+t.az.conf.state).attr("checked",!0),h.value=t.az.conf.attachAngle||1,v.value=t.az.conf.attachAngle||1),"N0"==a?(z.classList.add("az-hidden"),g.classList.add("az-hidden")):(z.classList.remove("az-hidden"),g.classList.remove("az-hidden")),"initial"!=t.az.conf.state&&"final"!=t.az.conf.state?(e("#nuclet--grow-label").addClass("az-hidden"),e("#edit-nuclet-grow-0").addClass("az-hidden"),e("#edit-nuclet-grow-1").addClass("az-hidden")):(e("#nuclet--grow-label").removeClass("hidden"),e("#edit-nuclet-grow-0").removeClass("az-hidden"),e("#edit-nuclet-grow-1").removeClass("az-hidden")),o(a+"0",p),o(a+"1",b),s=t}function c(t){function a(e,n){var o=t.az.nuclets[e],r=0,c=0;for(var s in o.az.protons){var i=o.az.protons[s];i.az&&i.az.visible&&("neutral"==i.az.type?c++:r++)}var l='<div class="nuclet shell-'+n+" "+o.name+'">'+e+" "+o.az.state+" - "+r;c&&(l+=" - "+c),l+="</div>\n";var d=t.az.nuclets[e+"0"],u=t.az.nuclets[e+"1"];return(d||u)&&(d&&(l+=a(e+"0",n+1)),u&&(l+=a(e+"1",n+1))),l}x.insertAfter(e("#blocks--nuclet-list")),y.html(a("N0",0)),$nucletButtons=y.find(".nuclet"),$nucletButtons.click(function(e){var t=e.target.innerHTML.split(" ")[0],a=m.atom.getNuclet(t);x.hasClass("az-hidden")||a!==s?(r(a),x.removeClass("az-hidden")):x.addClass("az-hidden")})}var s,i,l,d,u,m=t,f="none",g=e("#nuclet--attachAngle",m.context)[0],h=e("#nuclet--attachAngle--az-slider",m.context)[0],v=e("#nuclet--attachAngle--az-value",m.context)[0],z=e("#nuclet--delete",m.context)[0],p=e("#edit-nuclet-grow-0",m.context)[0],b=e("#edit-nuclet-grow-1",m.context)[0],y=e("#nuclet--list"),x=e("#blocks--nuclet-form"),j=(e(".az-controls-form",m.context),[]),C=[],k=[],A=[];h.addEventListener("input",function(e){m.atom.changeNucletAngle(s.az.id,e.target.value),m.render()}),z.addEventListener("click",function(e){m.atom.deleteNuclet(s.az.id),delete m.atom.az().nuclets[s.az.id],c(m.atom.atom),n(),m.render(),x.addClass("az-hidden")});var N=e("#edit-nuclet-state .az-control-radios",m.context);return N.click(function(t){"INPUT"==t.target.tagName&&(s=m.atom.changeNucletState(s,t.target.value),n(),m.render(),r(s)),e(this).attr("id",e(this).attr("id")+"--"+e(this).val())}),(N=e("#blocks--mouse-mode .az-control-radios",m.context)).click(function(t){"INPUT"==t.target.tagName&&(console.log("mode: "+t.target.value),f=t.target.value,e(this).attr("id",e(this).id+"--"+e(this).val()),"checked"==e(this).attr("checked")&&(f=e(this).val()))}),{createView:function(){m.nuclet=Drupal.atomizer.nucletC(m),m.atom=Drupal.atomizer.atomC(m);var e=localStorage.getItem("atomizer_builder_atom_niddy");m.view.atom=m.atom.loadAtom(e&&"undefined"!=e?e:249),m.view.ghostProton=m.nuclet.makeProton({type:"ghost"},1,{x:300,y:50,z:0},{state:"default"})},setDefaults:function(){if(userAtomFile=localStorage.getItem("atomizer_builder_atom_nid"),userAtomFile&&"undefined"!=userAtomFile){var t=e("#atom--selectyml",m.context)[0];t&&(select=t.querySelector("select"),select.value=userAtomFile)}},mouseClick:function(e){switch(e.which){case 1:case 3:switch(e.preventDefault(),f){case"none":break;case"protons":if((a=m.controls.findIntersects(k)).length){var t=a[0].object;t.az.optional&&(t.az.visible=!t.az.visible,t.material.visible=t.az.visible,m.atom.setValenceRings(),n(),m.render()),m.atom.showStats()}break;case"nuclets":var a=m.controls.findIntersects(A);return 0==a.length?(x.addClass("az-hidden"),s=void 0,!1):(s=a[0].object.parent.parent,x.removeClass("az-hidden"),x.insertAfter(y.find("."+s.name)),r(s),!1);case"inner-faces":var o=m.controls.findIntersects(j);if(o.length){for(var c=o[0].object,i=o[0].face,l=0;l<c.geometry.faces.length;l++)if(c.geometry.faces[l]===i){var d=c.geometry.reactiveState.indexOf(l);d>-1?c.geometry.reactiveState.splice(d,1):c.geometry.reactiveState.push(l);break}m.objects.icosaFaces=null;var u=m.nuclet.createGeometryFaces(c.name,1,c.geometry,c.geometry.compConf.rotation||null,c.geometry.reactiveState),g=c.parent;m.objects[c.name]=[],m.objects[c.name].push(u),u.geometry.reactiveState=c.geometry.reactiveState,u.geometry.compConf=c.geometry.compConf,g.remove(c),g.add(u),m.render()}}}},hoverObjects:function(){switch(f){case"none":return null;case"protons":return k;case"nuclets":return A;case"inner-faces":return m.objects.icosaFaces;case"outer-faces":return C}},hovered:function(e){switch(f){case"none":return[];case"protons":if(m.theme.get("proton--opacity"),i){if(e.length&&i==e[0])return;var t=i.object,a=m.theme.get("proton-"+t.az.type+"--color");t.material.color.setHex(parseInt(a.replace(/#/,"0x")),16),t.material.visible=t.az.visible}if(e.length){if(!e[0].object.az.optional||!e[0].object.az.active)return;(i=e[0]).object.material.visible=!0,a=m.theme.get("proton-ghost--color"),i.object.material.color.setHex(parseInt(a.replace(/#/,"0x")),16)}break;case"nuclets":break;case"inner-faces":if(m.theme.get("icosaFaces--opacity--az-slider"),l){if(e.length&&l==e[0])return;l.color.setHex(parseInt("0x00ff00")),d.geometry.colorsNeedUpdate=!0,l=null}e.length&&(l=e[0].face,d=e[0].object,l.color.setHex(parseInt("0x00ffff")),d.geometry.colorsNeedUpdate=!0,d.geometry.elementsNeedUpdate=!0,d.geometry.dynamic=!0,d.geometry.verticesNeedUpdate=!0);break;case"outer-faces":if(m.theme.get(" icosaOutFaces--opacity"),u){if(e.length&&u==e[0])return;u.color.setHex(parseInt("0xff00ff")),u=null}e.length&&(u=e[0].face).color.setHex(parseInt("0xffff00")),e[0].object.geometry.colorsNeedUpdate=!0}},atomLoaded:function(e){localStorage.setItem("atomizer_builder_atom_nid",e.az.nid),n(),m.objects.icosaFaces&&(j=m.objects.icosaFaces),m.objects.icosaOutFaces&&(C=m.objects.icosaOutFaces),c(e)}}}}(jQuery);
Drupal.atomizer.producers.atom_viewerC=function(e){var t=e;return{createView:function(){t.nuclet=Drupal.atomizer.nucletC(t),t.atom=Drupal.atomizer.atomC(t),t.view.atom=t.atom.loadAtom(t.atomizer.nid,null),t.view.ghostProton=t.nuclet.makeProton({type:"ghost"},1,{x:300,y:50,z:0})},setDefaults:function(){if(userAtomFile=localStorage.getItem("atomizer_viewer_atom"),userAtomFile&&"undefined"!=userAtomFile){var e=$("#atom--selectyml",t.context)[0];e&&(select=e.querySelector("select"),select.value=userAtomFile)}},mouseClick:function(e){switch(e.which){case 1:case 3:e.preventDefault()}},hoverObjects:function(){return[]},hovered:function(e){},atomLoaded:function(e){localStorage.setItem("atomizer_viewer_atom_nid",e.az.nid)}}};
Drupal.atomizer.producers.backbone_builderC=function(e){function t(e,t,o){for(var r in s){var a=e[t[s[r]]];o?(a.currentHex=a.material.color.getHex(),a.material.color.setHex(o)):a.material.color.setHex(a.currentHex)}}var o,r,a,n=!1,i=e,s=["a","b","c"],c=[],d=i.theme.get("proton--radius"),p=0,l=0,h=new THREE.Group;h.name="atom",h.az={protons:{},tetrahedrons:{}};var m=function(e){var t=new THREE.Group;t.name="tetrahedron",t.protons=[],t.protonRadius=d;var o=new THREE.TetrahedronGeometry(1.222*i.nuclet.protonRadius);return o.dynamic=!0,t.add(i.nuclet.createGeometryWireframe(e+"Wireframe",1,o,null,null)),t.add(i.nuclet.createGeometryFaces(e+"Faces",1,o,null,null)),t},v=function(e){var t={name:e.name,protonRadius:d,protons:{},components:{}};for(var o in h.az.protons){var r=h.az.protons[o];t.protons[o]={position:r.position,attachments:[]}}for(var a in h.az.tetrahedrons){for(var n=h.az.tetrahedrons[a],i=[],s=0;s<n.protons.length;s++){o=n.protons[s].azid;i[s]=o,t.protons[o].attachments.push(a)}t.geometries[a]={geometry:"tetrahedron",protons:i}}Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:e.name,source:"backbone_builder",component:"theme",filepath:e.filepath,ymlContents:t},g)},g=function(e){},u=function(e){w(e)},f=function(e,t){Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{component:"backbone",settings:{fart:"cool"},filepath:e},w)},w=function(e){p=0,l=0,h&&i.scene.remove(h),(a=e[0].ymlContents).filepath=e[0].data.filepath,localStorage.setItem("atomizer_builder_backbone",e[0].data.filepath.replace(/^.*[\\\/]/,"")),(h=new THREE.Group).add(new THREE.AxisHelper(500)),h.name="atom",h.az={protons:[],tetrahedrons:[]};for(var t=0;t<2;t++)(n||1!=t)&&function(e){var t=new THREE.Geometry;for(var o in a.protons){var r=a.protons[o],s=new THREE.Vector3(r.position.x,r.position.y,r.position.z);t.vertices.push(s)}n&&(t.applyMatrix((new THREE.Matrix4).makeRotationY(Math.PI/4)),t.applyMatrix((new THREE.Matrix4).makeTranslation(-t.vertices[8].x,-t.vertices[8].y,0)),t.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI)),t.applyMatrix((new THREE.Matrix4).makeRotationZ(-Math.PI/2.125)),t.verticesNeedUpdate=!0,i.render(),1==e&&(t.applyMatrix((new THREE.Matrix4).makeRotationZ(Math.PI)),t.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI))),t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-t.vertices[6].y,0)));var d=0;for(var o in a.protons){var r=a.protons[o],v=t.vertices[d];(f=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:v.x,y:v.y,z:v.z})).azid="p"+l++,h.az.protons[f.azid]=f,h.add(f),d++}var g=i.sprites.createVerticeIds("proton",t);h.add(g);for(var y in a.components){var u=a.components[y];if("tetrahedron"==u.geometry){var z=m("tetra");z.azid="t"+p++,c.push(z.children[1]),h.az.tetrahedrons[z.azid]=z,z.children[1].geometry.protons=[];for(var x=0;x<4;x++){1==e?"p09"==(o="p"+(parseInt(u.protons[x].replace("p",""))+10).toString())&&(o="p9"):o=u.protons[x];var f=a.protons[o];z.children[0].geometry.vertices[x].x=h.az.protons[o].position.x,z.children[0].geometry.vertices[x].y=h.az.protons[o].position.y,z.children[0].geometry.vertices[x].z=h.az.protons[o].position.z,z.children[1].geometry.vertices[x].x=h.az.protons[o].position.x,z.children[1].geometry.vertices[x].y=h.az.protons[o].position.y,z.children[1].geometry.vertices[x].z=h.az.protons[o].position.z,z.protons[x]=h.az.protons[o]}h.add(z)}}}(t);if(n){var o;x=0,y=-80.25,z=50,(o=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:x,y:y,z:z})).azid="p18",h.az.protons.p18=o,h.add(o),(o=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:x,y:y,z:-z})).azid="p19",h.az.protons.p19=o,h.add(o)}i.scene.add(h),i.render()};return{setDefaults:function(){},createView:function(){i.nuclet=Drupal.atomizer.nucletC(i),i.atom=Drupal.atomizer.atomC(i),i.backbone={getYmlDirectory:function(){return"config/backbone"},saveYml:v,loadYml:u},i.view.ghostProton=i.nuclet.makeProton("ghost",i.theme.get("proton--opacity"),{x:300,y:50,z:0});var e=m("ghost");e.protons=[],i.view.ghostTetrahedron=e,f(n?"config/backbone/half_backbone.yml":"config/backbone/back.yml")},intersectObjects:function(){return c},intersected:function(e){if(0==e.length)o&&(t(r.protons,o),o=null,r.children[0].remove(i.view.ghostProton),r.children[0].remove(i.view.ghostTetrahedron),i.render());else if(o!=e[0].face){o&&(t(r.protons,o),r.children[0].remove(i.view.ghostProton),r.children[0].remove(i.view.ghostTetrahedron)),o=e[0].face,e[0].faceIndex,r=e[0].object.parent,o.centroid=new THREE.Vector3(0,0,0);for(var a in s){var n=o[s[a]],c=r.protons[n];o.centroid.add(c.position),i.view.ghostTetrahedron.children[0].geometry.vertices[a].copy(c.position),i.view.ghostTetrahedron.protons[a]=c}o.centroid.divideScalar(3);var d=o.normal,p={x:1.615*d.x*r.protonRadius,y:1.615*d.y*r.protonRadius,z:1.615*d.z*r.protonRadius},l={x:o.centroid.x+p.x,y:o.centroid.y+p.y,z:o.centroid.z+p.z};i.view.ghostProton.position.copy(l),r.children[0].add(i.view.ghostProton),i.view.ghostTetrahedron.children[0].geometry.vertices[3].copy(l),i.view.ghostTetrahedron.children[0].geometry.verticesNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.normalsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.elementsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.uvsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.tangentsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.computeFaceNormals(),i.view.ghostTetrahedron.children[0].geometry.computeVertexNormals(),i.view.ghostTetrahedron.children[1].geometry.vertices[3].copy(l),i.view.ghostTetrahedron.children[1].geometry.verticesNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.normalsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.elementsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.uvsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.tangentsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.computeFaceNormals(),i.view.ghostTetrahedron.children[1].geometry.computeVertexNormals(),r.children[0].add(i.view.ghostTetrahedron),color=i.theme.get("proton-vattach--color"),t(r.protons,o,color.replace("#","0x")),i.render()}},mouseClick:function(e){if(o){t(r.protons,o);var a=i.view.ghostProton;a.material.color.setHex(parseInt(i.theme.get("proton-default--color").replace(/#/,"0x")),16);var n=i.view.ghostTetrahedron;n.children[0].material.color.setHex(parseInt(i.theme.get("tetraWireframe--color").replace(/#/,"0x")),16),n.children[0].name="tetraWireframe",n.children[1].material.color.setHex(parseInt(i.theme.get("tetraFaces--color").replace(/#/,"0x")),16),n.children[1].name="tetraFaces",c.push(n.children[1]),a.azid="p"+Object.keys(h.az.protons).length,h.az.protons[a.azid]=a,n.protons[3]=a,n.azid="t"+Object.keys(h.az.tetrahedrons).length,h.az.tetrahedrons[n.azid]=n,o=null,r=null,i.view.ghostProton=i.nuclet.makeProton("ghost",i.theme.get("proton--opacity"),{x:300,y:50,z:0}),i.view.ghostTetrahedron=m("ghost"),i.render()}}}};
Drupal.atomizer.producers.molecule_builderC=function(e){var r=e;return{createView:function(){r.object.addAtoms()}}};
Drupal.atomizer.producers.periodic_tableC=function(e){var r=e;return{createView:function(){r.object.addAtoms()}}};
Drupal.atomizer.producers.platonic_solidsC=function(t){var o=t;o.controls=Drupal.atomizer.controlsC(o),o.nuclet=Drupal.atomizer.nucletC(o),o.atom=Drupal.atomizer.atomC(o);return{createView:function(){o.atom.createAtom({protons:[0,1,2,3],state:"tetrahedron"}).position.set(400,0,-200),o.atom.createAtom({protons:[0,1,2,3,4,5,6,7,8,9,10,11],state:"hexahedron"}).position.set(0,0,-200),o.atom.createAtom({protons:[0,1,2,3,4,5,6,7,8,9,10,11],state:"octahedron"}).position.set(-400,0,-200),o.atom.createAtom({protons:[0,1,2,3,4,5,6,7,8,9,10,11],state:"icosahedron"}).position.set(275,0,200),o.atom.createAtom({protons:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],state:"dodecahedron"}).position.set(-275,0,200)},setDefaults:function(){},mouseClick:function(){o.render()},hovered:function(){}}};
Drupal.atomizer.producers.workbenchC=function(e){var t=e,n=function(e,n){switch(e){case"tetralet":r={position:1,type:"tetralet",numProtons:4,protons:[{present:!0},{present:!0},{present:!0},{present:!0}]};break;case"decalet":r={position:1,type:"decalet",numProtons:7,protons:[{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0}]};break;case"icosalet":r={position:1,type:"icosalet",numProtons:12,protons:[{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0}]};break;case"octolet":var r={position:1,type:"octolet",numProtons:6,protons:[{present:!0},{present:!0},{present:!0},{present:!0},{present:!0},{present:!0}]}}return r.position={x:n.x,y:n.y,z:n.z},nuclet=t.nuclet.createNuclet(r)};return{createView:function(){t.nuclet=Drupal.atomizer.nucletC(t),t.atom=Drupal.atomizer.atomC(t);t.nuclet;var e=n("octolet",{x:0,y:92,z:-200});Drupal.atomizer.octolet=e,t.scene.add(e)},setDefaults:function(){},intersectObjects:function(){return[]},intersected:function(){},mouseClick:function(){}}};