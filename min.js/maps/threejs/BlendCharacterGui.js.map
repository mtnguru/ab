{"version":3,"sources":["threejs/BlendCharacterGui.js"],"names":["BlendCharacterGui","blendMesh","controls","gui","Show Model","Show Skeleton","Time Scale","Step Size","Crossfade Time","idle","walk","run","this","showModel","showSkeleton","getTimeScale","update","time","getWeight","getAnimationData","detail","anims","weights","start","startEvent","CustomEvent","window","dispatchEvent","stop","stopEvent","pause","pauseEvent","step","stepData","stepSize","weight","sum","weightEvent","crossfade","from","to","fadeData","warp","warpData","showSkeletonChanged","data","shouldShow","showModelChanged","dat","GUI","settings","addFolder","playback","blending","add","onChange","listen","open","call"],"mappings":"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","file":"../../threejs/BlendCharacterGui.js","sourcesContent":["/**\n * @author Michael Guerrero / http://realitymeltdown.com\n */\n\nfunction BlendCharacterGui( blendMesh ) {\n\n\tvar controls = {\n\n\t\tgui: null,\n\t\t\"Show Model\": true,\n\t\t\"Show Skeleton\": false,\n\t\t\"Time Scale\": 1.0,\n\t\t\"Step Size\": 0.016,\n\t\t\"Crossfade Time\": 3.5,\n\t\t\"idle\": 0.33,\n\t\t\"walk\": 0.33,\n\t\t\"run\": 0.33\n\n\t};\n\n\tvar blendMesh = blendMesh;\n\n\tthis.showModel = function() {\n\n\t\treturn controls[ 'Show Model' ];\n\n\t};\n\n\tthis.showSkeleton = function() {\n\n\t\treturn controls[ 'Show Skeleton' ];\n\n\t};\n\n\tthis.getTimeScale = function() {\n\n\t\treturn controls[ 'Time Scale' ];\n\n\t};\n\n\tthis.update = function( time ) {\n\n\t\tcontrols[ 'idle' ] = blendMesh.getWeight( 'idle' );\n\t\tcontrols[ 'walk' ] = blendMesh.getWeight( 'walk' );\n\t\tcontrols[ 'run' ] = blendMesh.getWeight( 'run' );\n\n\t};\n\n\tvar init = function() {\n\n\t\tcontrols.gui = new dat.GUI();\n\n\t\tvar settings = controls.gui.addFolder( 'Settings' );\n\t\tvar playback = controls.gui.addFolder( 'Playback' );\n\t\tvar blending = controls.gui.addFolder( 'Blend Tuning' );\n\n\t\tsettings.add( controls, \"Show Model\" ).onChange( controls.showModelChanged );\n\t\tsettings.add( controls, \"Show Skeleton\" ).onChange( controls.showSkeletonChanged );\n\t\tsettings.add( controls, \"Time Scale\", 0, 1, 0.01 );\n\t\tsettings.add( controls, \"Step Size\", 0.01, 0.1, 0.01 );\n\t\tsettings.add( controls, \"Crossfade Time\", 0.1, 6.0, 0.05 );\n\n\t\t// These controls execute functions\n\t\tplayback.add( controls, \"start\" );\n\t\tplayback.add( controls, \"pause\" );\n\t\tplayback.add( controls, \"step\" );\n\t\tplayback.add( controls, \"idle to walk\" );\n\t\tplayback.add( controls, \"walk to run\" );\n\t\tplayback.add( controls, \"warp walk to run\" );\n\n\t\tblending.add( controls, \"idle\", 0, 1, 0.01 ).listen().onChange( controls.weight );\n\t\tblending.add( controls, \"walk\", 0, 1, 0.01 ).listen().onChange( controls.weight );\n\t\tblending.add( controls, \"run\", 0, 1, 0.01 ).listen().onChange( controls.weight );\n\n\t\tsettings.open();\n\t\tplayback.open();\n\t\tblending.open();\n\n\t};\n\n\tvar getAnimationData = function() {\n\n\t\treturn {\n\n\t\t\tdetail: {\n\n\t\t\t\tanims: [ \"idle\", \"walk\", \"run\" ],\n\n\t\t\t\tweights: [ controls[ 'idle' ],\n\t\t\t\t\t\t   controls[ 'walk' ],\n\t\t\t\t\t\t   controls[ 'run' ] ]\n\t\t\t}\n\n\t\t};\n\n\t};\n\n\tcontrols.start = function() {\n\n\t\tvar startEvent = new CustomEvent( 'start-animation', getAnimationData() );\n\t\twindow.dispatchEvent( startEvent );\n\n\t};\n\n\tcontrols.stop = function() {\n\n\t\tvar stopEvent = new CustomEvent( 'stop-animation' );\n\t\twindow.dispatchEvent( stopEvent );\n\n\t};\n\n\tcontrols.pause = function() {\n\n\t\tvar pauseEvent = new CustomEvent( 'pause-animation' );\n\t\twindow.dispatchEvent( pauseEvent );\n\n\t};\n\n\tcontrols.step = function() {\n\n\t\tvar stepData = { detail: { stepSize: controls[ 'Step Size' ] } };\n\t\twindow.dispatchEvent( new CustomEvent( 'step-animation', stepData ) );\n\n\t};\n\n\tcontrols.weight = function() {\n\n\t\t// renormalize\n\t\tvar sum = controls[ 'idle' ] + controls[ 'walk' ] + controls[ 'run' ];\n\t\tcontrols[ 'idle' ] /= sum;\n\t\tcontrols[ 'walk' ] /= sum;\n\t\tcontrols[ 'run' ] /= sum;\n\n\t\tvar weightEvent = new CustomEvent( 'weight-animation', getAnimationData() );\n\t\twindow.dispatchEvent( weightEvent );\n\n\t};\n\n\tcontrols.crossfade = function( from, to ) {\n\n\t\tvar fadeData = getAnimationData();\n\t\tfadeData.detail.from = from;\n\t\tfadeData.detail.to = to;\n\t\tfadeData.detail.time = controls[ \"Crossfade Time\" ];\n\n\t\twindow.dispatchEvent( new CustomEvent( 'crossfade', fadeData ) );\n\n\t};\n\n\tcontrols.warp = function( from, to ) {\n\n\t\tvar warpData = getAnimationData();\n\t\twarpData.detail.from = 'walk';\n\t\twarpData.detail.to = 'run';\n\t\twarpData.detail.time = controls[ \"Crossfade Time\" ];\n\n\t\twindow.dispatchEvent( new CustomEvent( 'warp', warpData ) );\n\n\t};\n\n\tcontrols[ 'idle to walk' ] = function() {\n\n\t\tcontrols.crossfade( 'idle', 'walk' );\n\n\t};\n\n\tcontrols[ 'walk to run' ] = function() {\n\n\t\tcontrols.crossfade( 'walk', 'run' );\n\n\t};\n\n\tcontrols[ 'warp walk to run' ] = function() {\n\n\t\tcontrols.warp( 'walk', 'run' );\n\n\t};\n\n\tcontrols.showSkeletonChanged = function() {\n\n\t\tvar data = {\n\t\t\tdetail: {\n\t\t\t\tshouldShow: controls[ 'Show Skeleton' ]\n\t\t\t}\n\t\t};\n\n\t\twindow.dispatchEvent( new CustomEvent( 'toggle-show-skeleton', data ) );\n\n\t};\n\n\n\tcontrols.showModelChanged = function() {\n\n\t\tvar data = {\n\t\t\tdetail: {\n\t\t\t\tshouldShow: controls[ 'Show Model' ]\n\t\t\t}\n\t\t};\n\n\t\twindow.dispatchEvent( new CustomEvent( 'toggle-show-model', data ) );\n\n\t};\n\n\n\tinit.call( this );\n\n}\n"]}