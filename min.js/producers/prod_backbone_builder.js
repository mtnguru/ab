Drupal.atomizer.producers.backbone_builderC=function(e){function t(e,t,o){for(var r in s){var a=e[t[s[r]]];o?(a.currentHex=a.material.color.getHex(),a.material.color.setHex(o)):a.material.color.setHex(a.currentHex)}}var o,r,a,n=!1,i=e,s=["a","b","c"],c=[],d=i.theme.get("proton--radius"),p=0,l=0,h=new THREE.Group;h.name="atom",h.az={protons:{},tetrahedrons:{}};var m=function(e){var t=new THREE.Group;t.name="tetrahedron",t.protons=[],t.protonRadius=d;var o=new THREE.TetrahedronGeometry(1.222*i.nuclet.protonRadius);return o.dynamic=!0,t.add(i.nuclet.createGeometryWireframe(e+"Wireframe",1,o,null,null)),t.add(i.nuclet.createGeometryFaces(e+"Faces",1,o,null,null)),t},v=function(e){var t={name:e.name,protonRadius:d,protons:{},components:{}};for(var o in h.az.protons){var r=h.az.protons[o];t.protons[o]={position:r.position,attachments:[]}}for(var a in h.az.tetrahedrons){for(var n=h.az.tetrahedrons[a],i=[],s=0;s<n.protons.length;s++){o=n.protons[s].azid;i[s]=o,t.protons[o].attachments.push(a)}t.geometries[a]={geometry:"tetrahedron",protons:i}}Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:e.name,source:"backbone_builder",component:"theme",filepath:e.filepath,ymlContents:t},g)},g=function(e){},u=function(e){w(e)},f=function(e,t){Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{component:"backbone",settings:{fart:"cool"},filepath:e},w)},w=function(e){p=0,l=0,h&&i.scene.remove(h),(a=e[0].ymlContents).filepath=e[0].data.filepath,localStorage.setItem("atomizer_builder_backbone",e[0].data.filepath.replace(/^.*[\\\/]/,"")),(h=new THREE.Group).add(new THREE.AxisHelper(500)),h.name="atom",h.az={protons:[],tetrahedrons:[]};for(var t=0;t<2;t++)(n||1!=t)&&function(e){var t=new THREE.Geometry;for(var o in a.protons){var r=a.protons[o],s=new THREE.Vector3(r.position.x,r.position.y,r.position.z);t.vertices.push(s)}n&&(t.applyMatrix((new THREE.Matrix4).makeRotationY(Math.PI/4)),t.applyMatrix((new THREE.Matrix4).makeTranslation(-t.vertices[8].x,-t.vertices[8].y,0)),t.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI)),t.applyMatrix((new THREE.Matrix4).makeRotationZ(-Math.PI/2.125)),t.verticesNeedUpdate=!0,i.render(),1==e&&(t.applyMatrix((new THREE.Matrix4).makeRotationZ(Math.PI)),t.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI))),t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-t.vertices[6].y,0)));var d=0;for(var o in a.protons){var r=a.protons[o],v=t.vertices[d];(f=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:v.x,y:v.y,z:v.z})).azid="p"+l++,h.az.protons[f.azid]=f,h.add(f),d++}var g=i.sprites.createVerticeIds("proton",t);h.add(g);for(var y in a.components){var u=a.components[y];if("tetrahedron"==u.geometry){var z=m("tetra");z.azid="t"+p++,c.push(z.children[1]),h.az.tetrahedrons[z.azid]=z,z.children[1].geometry.protons=[];for(var x=0;x<4;x++){1==e?"p09"==(o="p"+(parseInt(u.protons[x].replace("p",""))+10).toString())&&(o="p9"):o=u.protons[x];var f=a.protons[o];z.children[0].geometry.vertices[x].x=h.az.protons[o].position.x,z.children[0].geometry.vertices[x].y=h.az.protons[o].position.y,z.children[0].geometry.vertices[x].z=h.az.protons[o].position.z,z.children[1].geometry.vertices[x].x=h.az.protons[o].position.x,z.children[1].geometry.vertices[x].y=h.az.protons[o].position.y,z.children[1].geometry.vertices[x].z=h.az.protons[o].position.z,z.protons[x]=h.az.protons[o]}h.add(z)}}}(t);if(n){var o;x=0,y=-80.25,z=50,(o=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:x,y:y,z:z})).azid="p18",h.az.protons.p18=o,h.add(o),(o=i.nuclet.makeProton("default",i.theme.get("proton--opacity"),{x:x,y:y,z:-z})).azid="p19",h.az.protons.p19=o,h.add(o)}i.scene.add(h),i.render()};return{setDefaults:function(){},createView:function(){i.nuclet=Drupal.atomizer.nucletC(i),i.atom=Drupal.atomizer.atomC(i),i.backbone={getYmlDirectory:function(){return"config/backbone"},saveYml:v,loadYml:u},i.view.ghostProton=i.nuclet.makeProton("ghost",i.theme.get("proton--opacity"),{x:300,y:50,z:0});var e=m("ghost");e.protons=[],i.view.ghostTetrahedron=e,f(n?"config/backbone/half_backbone.yml":"config/backbone/back.yml")},intersectObjects:function(){return c},intersected:function(e){if(0==e.length)o&&(t(r.protons,o),o=null,r.children[0].remove(i.view.ghostProton),r.children[0].remove(i.view.ghostTetrahedron),i.render());else if(o!=e[0].face){o&&(t(r.protons,o),r.children[0].remove(i.view.ghostProton),r.children[0].remove(i.view.ghostTetrahedron)),o=e[0].face,e[0].faceIndex,r=e[0].object.parent,o.centroid=new THREE.Vector3(0,0,0);for(var a in s){var n=o[s[a]],c=r.protons[n];o.centroid.add(c.position),i.view.ghostTetrahedron.children[0].geometry.vertices[a].copy(c.position),i.view.ghostTetrahedron.protons[a]=c}o.centroid.divideScalar(3);var d=o.normal,p={x:1.615*d.x*r.protonRadius,y:1.615*d.y*r.protonRadius,z:1.615*d.z*r.protonRadius},l={x:o.centroid.x+p.x,y:o.centroid.y+p.y,z:o.centroid.z+p.z};i.view.ghostProton.position.copy(l),r.children[0].add(i.view.ghostProton),i.view.ghostTetrahedron.children[0].geometry.vertices[3].copy(l),i.view.ghostTetrahedron.children[0].geometry.verticesNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.normalsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.elementsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.uvsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.tangentsNeedUpdate=!0,i.view.ghostTetrahedron.children[0].geometry.computeFaceNormals(),i.view.ghostTetrahedron.children[0].geometry.computeVertexNormals(),i.view.ghostTetrahedron.children[1].geometry.vertices[3].copy(l),i.view.ghostTetrahedron.children[1].geometry.verticesNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.normalsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.elementsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.uvsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.tangentsNeedUpdate=!0,i.view.ghostTetrahedron.children[1].geometry.computeFaceNormals(),i.view.ghostTetrahedron.children[1].geometry.computeVertexNormals(),r.children[0].add(i.view.ghostTetrahedron),color=i.theme.get("proton-vattach--color"),t(r.protons,o,color.replace("#","0x")),i.render()}},mouseClick:function(e){if(o){t(r.protons,o);var a=i.view.ghostProton;a.material.color.setHex(parseInt(i.theme.get("proton-default--color").replace(/#/,"0x")),16);var n=i.view.ghostTetrahedron;n.children[0].material.color.setHex(parseInt(i.theme.get("tetraWireframe--color").replace(/#/,"0x")),16),n.children[0].name="tetraWireframe",n.children[1].material.color.setHex(parseInt(i.theme.get("tetraFaces--color").replace(/#/,"0x")),16),n.children[1].name="tetraFaces",c.push(n.children[1]),a.azid="p"+Object.keys(h.az.protons).length,h.az.protons[a.azid]=a,n.protons[3]=a,n.azid="t"+Object.keys(h.az.tetrahedrons).length,h.az.tetrahedrons[n.azid]=n,o=null,r=null,i.view.ghostProton=i.nuclet.makeProton("ghost",i.theme.get("proton--opacity"),{x:300,y:50,z:0}),i.view.ghostTetrahedron=m("ghost"),i.render()}}}};
//# sourceMappingURL=../maps/producers/prod_backbone_builder.js.map
