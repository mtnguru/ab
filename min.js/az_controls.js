!function(e){Drupal.atomizer.controlsC=function(t,a){function n(e){switch(E){case"atom_builder":g.dispose(),delete g,y.canvasContainer.removeEventListener("mousemove",h);break;case"camera":g.dispose(),delete g;break;case"atom":k.dispose(),delete k;break;case"attach":y.canvasContainer.removeEventListener("mousemove",h)}switch(E=e){case"atom_builder":g=m(),y.canvasContainer.addEventListener("mousemove",h,!1),y.canvasContainer.addEventListener("mouseup",b,!1);break;case"camera":g=m();break;case"atom":k=p(Drupal.atomizer.octolet);break;case"attach":y.canvasContainer.addEventListener("mousemove",h,!1)}}function o(t){var a=this.id.split("--");this.className.indexOf("az-slider")>-1?e("#"+a[0]+"--"+a[1]+"--"+a[2]+"--az-value",y.context)[0].value=t.target.value:this.className.indexOf("az-control-range")>-1&&(e("#"+this.id+"--az-value",y.context)[0].value=t.target.value),y.theme.applyControl(this.id,t.target.value)}function r(e){var t=this.id.split("--");Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{component:t[0],filepath:y[t[0]].getYmlDirectory()+"/"+e.target.value,filename:e.target.value},y[t[0]].loadYml)}function s(t){t.preventDefault();var a=this.id.split("--");switch(a[1]){case"selectyml":y[a[0]].overwriteYml();break;case"saveyml":var n=e("3"+a[0]+"--saveyml",y.context)[0],o=n.querySelector("input[name=name]").value,r=n.querySelector("input[name=filename]").value;o.length&&(0==r.length&&(r=o),-1==r.indexOf(".yml")&&(r+=".yml"),y[a[0]].saveYml({name:o,filepath:y[a[0]].getYmlDirectory()+"/"+r.replace(/[|&;$%@"<>()+,]/g,"").replace(/[ -]/g,"_")}));break;default:"viewer"===a[0]?y.buttonClicked(t.target):y[a[0]]&&y[a[0]].buttonClicked&&(t.preventDefault(),y[a[0]].buttonClicked(t.target))}return!1}function i(t){if(null==a){$html='<div class="NaN';var a=e("#blocks--popup",y.context);$html='<div class="az-popup"><div class="az-popup-titlebar"><div class="az-popup-title">Yo Dude</div></div><div class="az-popup-content">Hey James</div></div>'}}function c(t){t.preventDefault();var a=e(t.target).data("nid"),n=e(t.target).data("viewmode");Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{nid:a,viewMode:n,popupId:"popupNode"},i)}function l(){if(y.atomizer.theme)for(var t in y.atomizer.theme.settings){var a=y.atomizer.theme.settings[t],n=t.replace(/_/g,"-");if(e("#"+n,y.context)[0]||"rotation"==a.type||"position"==a.type)switch(a.type){case"color":case"range":y.theme.set(a.defaultValue,n,a.type);break;case"rotation":case"position":var o;o=n+"--az-slider",y.theme.set(a.defaultValue,o,a.type)}}}function d(){for(var t=0;t<C.length;t++)if(C[t].selected){var a=C[t].id.split("--")[1];u(e(a))}}function u(t){e("#blocks--theme .control-block").addClass("az-hidden");var a=e("#blocks--"+C.value);a.insertAfter(e(C)),a.removeClass("az-hidden")}function v(){if(l(),e(".az-controls-form",y.context)[0]){d(),C.addEventListener("change",function(t){u(e("#blocks--"+t.value))});for(var t in y.atomizer.theme.settings){var a=y.atomizer.theme.settings[t],n=t.replace(/_/g,"-"),i=e("#"+n,y.context)[0];if(i||"rotation"==a.type||"position"==a.type)switch(a.type){case"color":case"range":i.addEventListener("input",o);break;case"rotation":case"position":var v=n+"--az-slider";e("#"+v,y.context)[0].addEventListener("input",o),y.theme.set(a.defaultValue,v,a.type);break;case"saveyml":e("#"+n+"--button",y.context)[0];e("#"+n+"--button",y.context)[0].addEventListener("click",s);break;case"selectyml":i.addEventListener("change",r);break;case"link":case"button":case"toggle":i.addEventListener("click",s);break;case"popup-node":i.addEventListener("click",c)}}return e(".toggle-block").click(function(t){var a=e("#"+e(this).data("blockid"));if(a.hasClass("az-hidden")){var n=e(this).data("blockid");a.removeClass("az-hidden"),e(this).addClass("az-selected"),a.insertAfter(e("#blocks--buttons")),"blocks--theme"===n&&d()}else a.addClass("az-hidden"),e(this).removeClass("az-selected")}),!1}}function m(){var e=new THREE.OrbitControls(y.camera,y.renderer.domElement);return e.rotateSpeed=.25,e.zoomSpeed=.5,e.panSpeed=.5,e.enableZoom=!0,e.enablePan=!0,e.enableDamping=!0,e.dampingFactor=.3,e.keys=[65,83,68],e}function p(e){var t=new THREE.TrackballControls(e,y.renderer.domElement);return t.rotateSpeed=2,t.zoomSpeed=1,t.panSpeed=3,t.noZoom=!1,t.noPan=!1,t.staticMoving=!0,t.keys=[65,83,68],t.addEventListener("change",y.render),t}function f(e){if(e){var t=new THREE.Vector3(x.x,x.y,.5);t.unproject(y.camera);var a=new THREE.Raycaster(y.camera.position,t.sub(y.camera.position).normalize());y.render();var n=a.intersectObjects(e);if(n.length);return n}return[]}function h(e){x.x=e.offsetX/y.canvasWidth*2-1,x.y=-e.offsetY/y.canvasHeight*2+1,y.producer.hoverObjects&&y.producer.hovered(f(y.producer.hoverObjects())),y.render()}function b(e){if(x.x=e.offsetX/y.canvasWidth*2-1,x.y=-e.offsetY/y.canvasHeight*2+1,y.producer.mouseClick)return y.producer.mouseClick(e)}var g,k,z,y=t,E=(Drupal.atomizer.base.constants,"none"),C=e("#theme--selectBlock",y.context)[0],x=new THREE.Vector2(-1e3,-1e3);return{init:function(){v(),n("atom_builder"),y.producer.setDefaults&&y.producer.setDefaults(),(z=new THREE.Raycaster).ray.direction.set(0,-1,0),y.controls.projector=new THREE.Projector},getDefault:function(t,a){var n=e("#"+t,y.context);return n.length?n.hasClass("az-control-range")||n.hasClass("az-control-rotation")||n.hasClass("az-control-position")?a?e("#"+t+"--"+a+"--az-slider",y.context)[0].value:e("#"+t+"--az-slider",y.context)[0].value:n.hasClass("az-control-radios")?e("input[name="+n.attr("id")+"]:checked").val():n.val():(console.log("atomizer_controls.js - control not found - "+t),null)},findIntersects:f,cameraTrackballControls:g}}}(jQuery);
//# sourceMappingURL=maps/az_controls.js.map
