!function(a){"use strict";Drupal.imager.popups.colorC=function(t){var e,i=Drupal.imager.popups,n=Drupal.imager.viewer,s=0,o=0,l=0,r=a.extend({name:"Color",autoOpen:!1,title:"Hue/Saturation/Lightness",zIndex:1015,width:"auto",dialogClass:"imager-dialog imager-color-dialog imager-noclose",draggable:!0,cssId:"imager-color",height:"auto",resizable:!1,position:{my:"left",at:"right",of:t.$selectButton}},t);return e=i.baseC(r),e.dialogOnCreate=function(){e.dialogOpen(),e.draggable()},e.dialogOnOpen=function(){n.setInitialImage(),e.dialogInit()},e.dialogOnClose=function(){},e.init=function(){s=0,o=0,l=0,e.updateStatus()},e.dialogInit=function(){e.init(),e.dialogIsOpen()&&(a("#slider-hue").change(function(){e.adjustColor(n.$canvas2,n.$canvas)}),a("#slider-saturation").change(function(){e.adjustColor(n.$canvas2,n.$canvas)}),a("#slider-lightness").change(function(){e.adjustColor(n.$canvas2,n.$canvas)}),a("#slider-hue").val(s),a("#slider-saturation").val(o),a("#slider-lightness").val(0))},e.adjustColor=function(t,i){s=parseInt(100*a("#slider-hue").val())/100,o=parseInt(100*a("#slider-saturation").val())/9e3,l=parseInt(100*a("#slider-lightness").val())/1e4,e.updateStatus();var n,r=t.attr("width"),u=t.attr("height"),d=t[0].getContext("2d"),g=i[0].getContext("2d"),p=d.getImageData(0,0,r,u),c=p.data;n=o<0?1+o:1+2*o;for(var v=6*(s=s%360/360),h=255*l,f=1+l,C=1-l,I=r*u,m=4*I,$=m+1,O=m+2;I--;){var j,y,b,D=c[m-=4],x=c[$=m+1],S=c[O=m+2];if(0!==s||0!==o){var w=D;x>w&&(w=x),S>w&&(w=S);var A=D;x<A&&(A=x),S<A&&(A=S);var R=w-A,z=(A+w)/510;if(z>0&&R>0){z<=.5?((y=R/(w+A)*n)>1&&(y=1),b=z*(1+y)):((y=R/(510-w-A)*n)>1&&(y=1),b=z+y-z*y),(j=D===w?x===A?5+(w-S)/R+v:1-(w-x)/R+v:x===w?S===A?1+(w-D)/R+v:3-(w-S)/R+v:D===A?3+(w-x)/R+v:5-(w-D)/R+v)<0&&(j+=6),j>=6&&(j-=6);var U=z+z-b,B=j>>0;0===B?(D=255*b,x=255*(U+(b-U)*(j-B)),S=255*U):1===B?(D=255*(b-(b-U)*(j-B)),x=255*b,S=255*U):2===B?(D=255*U,x=255*b,S=255*(U+(b-U)*(j-B))):3===B?(D=255*U,x=255*(b-(b-U)*(j-B)),S=255*b):4===B?(D=255*(U+(b-U)*(j-B)),x=255*U,S=255*b):5===B&&(D=255*b,x=255*U,S=255*(b-(b-U)*(j-B)))}}l<0?(D*=f,x*=f,S*=f):l>0&&(D=D*C+h,x=x*C+h,S=S*C+h),c[m]=D<0?0:D>255?255:D,c[$]=x<0?0:x>255?255:x,c[O]=S<0?0:S>255?255:S}g.putImageData(p,0,0)},e.dialogReset=function(){e.init(),e.dialogIsOpen()&&(a("#slider-hue").val(0),a("#slider-saturation").val(0),a("#slider-lightness").val(0),e.adjustColor(n.$canvas2,n.$canvas))},e.dialogApply=function(){n.applyFilter(e.adjustColor)},e.dialogUpdate=function(){},e.updateStatus=function(){i.status.dialogUpdate({hue:parseInt(100*s)/100,saturation:parseInt(100*o)/100,lightness:parseInt(100*l)/100})},e.spec.buttons={Apply:e.dialogApply,Reset:e.dialogReset,Cancel:e.dialogClose},e}}(jQuery);
//# sourceMappingURL=../maps/popups/popups_color.js.map
