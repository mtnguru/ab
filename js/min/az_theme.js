!function(e){"use strict";Drupal.atomizer.themeC=function(a,t){var i=a,r={},l={},n=i.atomizer.themeDirectory,s=e("#theme--message",i.context)[0],o=function(a){localStorage.setItem("atomizer_theme_file",a[0].data.filename),e("#blocks--theme select.form-select").val(a[0].data.filename),a[0].ymlContents&&(a[0].ymlContents.filepath=a[0].data.filepath,l=a[0].ymlContents,r.name?(d(!1,!1),r.name=l.name,r.description=l.description,r.filepath=l.filepath):(r=JSON.parse(JSON.stringify(l)),d(!0,!0)),t&&(t(),t=null))},m=function(e){s.innerHTML=".... Loading Theme list",Drupal.atomizer.base.doAjax("/ajax-ab/listDirectory",{directory:n,component:"theme"},c)},c=function(a){for(var t=e("#theme--selectyml--select",i.context)[0];t.hasChildNodes();)t.removeChild(t.lastChild);for(var l in a[0].filelist){var n=document.createElement("option");n.appendChild(document.createTextNode(a[0].filelist[l])),n.value=l,t.appendChild(n)}t.value=r.filepath.replace(/^.*[\\\/]/,"");e("#theme--saveNewName",i.context)[0].value="";s.innerHTML="Theme saved successfully",setTimeout(function(){s.innerHTML=""},3e3)},f=function(e){var a=e.settings,t=Object.keys(a).sort();delete e.settings,e.settings={};for(var i in t){t[i];e.settings[t[i]]=a[t[i]]}Drupal.atomizer.base.doAjax("/ajax-ab/saveYml",{name:e.name,component:"theme",filepath:e.filepath,ymlContents:e},m)},d=function(a,t){var i;for(var n in r.settings)if("[object Array]"===Object.prototype.toString.call(r.settings[n].defaultValue)){var s=n.split("--"),o="xyz".indexOf(s[2]);if(i=l.settings[n].defaultValue[o],t||r.settings[n].defaultValue[o]!=i){a||p(n,i);var m;(m=e("#"+n)[0])&&(m.value=i),(m=e("#"+n+"--az-value")[0])&&(m.value=i)}}else l.settings[n]?i=l.settings[n].defaultValue:console.log("Error: No defaultValue found for "+n+" in "+l.filepath),(t||r.settings[n].defaultValue!=i)&&(a||p(n,l.settings[n].defaultValue),(m=e("#"+n)[0])&&(m.className.indexOf("az-control-range")>-1?(e("#"+n+"--az-slider").val(i),e("#"+n+"--az-value").val(i)):m.value=i))},p=function(e,a){var t=e.split("--"),l=t[0].split("-");switch(4===t.length?r.settings[t[0]+"--"+t[1]+"--"+t[2]+"--"+t[3]].defaultValue=a:3===t.length?r.settings[t[0]+"--"+t[1]+"--"+t[2]].defaultValue=a:r.settings[t[0]+"--"+t[1]].defaultValue=a,l[0]){case"renderer":i.renderer.setClearColor(new THREE.Color(parseInt(a.replace(/^#/,""),16)),1);break;case"camera":"perspective"==t[1]&&(i.camera.fov=a,i.camera.updateProjectionMatrix());break;default:i.scene.traverse(function(e){var i=e.name.split("-"),n=!1;if("atom"==t[0]?"atom"==i[0]&&(n=!0):"decahedron"==t[0]?"lithium"==i[0]&&(n=!0):t[0].indexOf("wireframe")>-1&&"scale"==t[1]&&i[0].indexOf("face")>-1&&i[0].charAt(0)==t[0].charAt(0)?n=!0:2==l.length?t[0]==e.name&&(n=!0):i[0]==l[0]&&(n=!0),n)switch(t[1]){case"rotation":var s=a/360*2*Math.PI;e.rotation[t[2]]=s+(e.rotation["init_"+t[2]]||0);break;case"position":e.position[t[2]]=a;break;case"scale":var o=a;console.log("applyControl  configuration "+o),e.scale.set(o,o,o);break;case"width":case"depth":"plane"==l[0]&&(e.geometry=THREE.PlaneBufferGeometry(r["plane--width"],r["plane--depth"]));break;case"opacity":var m=a,c=a>.02,f=a<.97;if("proton"==l[0])e.az.active&&(e.material.opacity=m,e.material.visible=c,e.material.transparent=f);else if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.opacity=m,e.children[d].material.visible=c,e.children[d].material.transparent=f;else e.material.opacity=m,e.material.visible=c,e.material.transparent=f;else e.material.materials?(e.material.materials[1].opacity=m,e.material.materials[1].visible=c,e.material.materials[1].transparent=f):e.material[0]?(e.material[0].opacity=m,e.material[0].visible=c,e.material[0].transparent=f):(e.material.opacity=m,e.material.visible=c,e.material.transparent=f);break;case"linewidth":if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.linewidth=a,e.children[d].material.visible=a>.05;else e.material.visible=a>.05,e.material.wireframeLinewidth=a;else e.material.linewidth=a,e.material.visible=a>.05;break;case"color":switch(l[0]){case"ambient":case"spotlight":e.color.setHex(parseInt(a.replace(/#/,"0x")),16);break;default:if(l[0].indexOf("Wireframe")>-1)if("dodecaWireframe"==e.name||"dodecaOutWireframe"==e.name||"hexaWireframe"==e.name)for(d=0;d<e.children.length;d++)e.children[d].material.color.setHex(parseInt(a.replace(/#/,"0x")),16);else e.material.color.setHex(parseInt(a.replace(/#/,"0x")),16);else if(e.material.materials)for(var d=0;d<e.material.materials.length;d++)e.material.materials[d].color.setHex(parseInt(a.replace(/#/,"0x")),16);else e.material.color.setHex(parseInt(a.replace(/#/,"0x")),16)}}})}i.render()},h=localStorage.getItem("atomizer_theme_file");return h&&"undefined"!=h||(h=i.view.defaultTheme),i.view.themePath=i.atomizer.themeDirectory+"/"+h,Drupal.atomizer.base.doAjax("/ajax-ab/loadYml",{filepath:i.view.themePath,filename:h,directory:n,component:"theme"},o),{buttonClicked:function(a){switch(a.id){case"theme--saveButton":f(r);break;case"theme--saveNewButton":var t=e("#theme--saveNewName").val();if(t.length){var l=t.replace(/[|&;$%@"<>()+,]/g,"").replace(/[ -]/g,"_");-1==l.indexOf(".yml")&&(l+=".yml"),r.name=t,r.filepath=n+"/"+l,s.classList.remove("az-error"),s.innerHTML=".... Saving theme",f(r),setTimeout(function(){s.innerHTML=""},3e3)}else s.innerHTML="Please enter a Name....",s.classList.add("az-error");break;case"theme--reset":d();break;case"theme--cameraReset":i.camera.position.x=i.theme.get("camera--position","x"),i.camera.position.y=i.theme.get("camera--position","y"),i.camera.position.z=i.theme.get("camera--position","z"),i.camera.lookAt(i.scene.position),i.render()}},applyControl:p,loadYml:o,get:function(e,a){var t=e.split("--"),l=e;return a&&(l+="--"+a),"position"!=t[1]&&"rotation"!=t[1]||(l+="--az-slider"),r.settings[l]?r.settings[l].defaultValue:i.controls.getDefault(l,a)},set:function(e,a,t){r.settings[a]||(r.settings[a]={defaultValue:e,type:t})},getCurrentControls:function(){return r.settings},getYmlDirectory:function(){return n}}}}(jQuery);
//# sourceMappingURL=maps/az_theme.js.map
